2022-08-23 10:57:10.945899: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:57:10.949127: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:57:10.949440: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:57:10.949892: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-08-23 10:57:10.950604: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:57:10.950905: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:57:10.951186: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:57:11.234840: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:57:11.235120: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:57:11.235362: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:57:11.235594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 6539 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1070, pci bus id: 0000:0a:00.0, compute capability: 6.1
Logit total bits = 8, int bits = 3
Activation total bits = 8, int bits = 3
<keras.engine.functional.Functional object at 0x7f204410ef10>
#################
# MODEL SUMMARY #
#################
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 28, 28)]          0         
                                                                 
 flatten (Flatten)           (None, 784)               0         
                                                                 
 fq_dense (FQDense)          (None, 128)               100480    
                                                                 
 q_activation_1 (QActivation  (None, 128)              0         
 )                                                               
                                                                 
 fq_dense_1 (FQDense)        (None, 10)                1290      
                                                                 
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
None
#################
Training with ber = 0.0
Layer <fkeras.fdense.FQDense object at 0x7f2030735b90> has ber = 0.0
Layer <fkeras.fdense.FQDense object at 0x7f20306da3d0> has ber = 0.0
Epoch 1/20
  1/469 [..............................] - ETA: 8:52 - loss: 2.8381 - sparse_categorical_accuracy: 0.1719 48/469 [==>...........................] - ETA: 0s - loss: 0.7946 - sparse_categorical_accuracy: 0.7492   94/469 [=====>........................] - ETA: 0s - loss: 0.5778 - sparse_categorical_accuracy: 0.8212138/469 [=======>......................] - ETA: 0s - loss: 0.4869 - sparse_categorical_accuracy: 0.8518184/469 [==========>...................] - ETA: 0s - loss: 0.4345 - sparse_categorical_accuracy: 0.8684231/469 [=============>................] - ETA: 0s - loss: 0.3941 - sparse_categorical_accuracy: 0.8810276/469 [================>.............] - ETA: 0s - loss: 0.3641 - sparse_categorical_accuracy: 0.8902323/469 [===================>..........] - ETA: 0s - loss: 0.3427 - sparse_categorical_accuracy: 0.8971370/469 [======================>.......] - ETA: 0s - loss: 0.3229 - sparse_categorical_accuracy: 0.9029416/469 [=========================>....] - ETA: 0s - loss: 0.3072 - sparse_categorical_accuracy: 0.9077462/469 [============================>.] - ETA: 0s - loss: 0.2945 - sparse_categorical_accuracy: 0.9118
Epoch 1: val_loss improved from inf to 0.15474, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 2s 2ms/step - loss: 0.2923 - sparse_categorical_accuracy: 0.9124 - val_loss: 0.1547 - val_sparse_categorical_accuracy: 0.9520
Epoch 2/20
  1/469 [..............................] - ETA: 14s - loss: 0.1138 - sparse_categorical_accuracy: 0.9688 44/469 [=>............................] - ETA: 0s - loss: 0.1563 - sparse_categorical_accuracy: 0.9554  87/469 [====>.........................] - ETA: 0s - loss: 0.1487 - sparse_categorical_accuracy: 0.9564130/469 [=======>......................] - ETA: 0s - loss: 0.1446 - sparse_categorical_accuracy: 0.9582177/469 [==========>...................] - ETA: 0s - loss: 0.1435 - sparse_categorical_accuracy: 0.9577223/469 [=============>................] - ETA: 0s - loss: 0.1399 - sparse_categorical_accuracy: 0.9588263/469 [===============>..............] - ETA: 0s - loss: 0.1384 - sparse_categorical_accuracy: 0.9593302/469 [==================>...........] - ETA: 0s - loss: 0.1360 - sparse_categorical_accuracy: 0.9600341/469 [====================>.........] - ETA: 0s - loss: 0.1350 - sparse_categorical_accuracy: 0.9604376/469 [=======================>......] - ETA: 0s - loss: 0.1342 - sparse_categorical_accuracy: 0.9604410/469 [=========================>....] - ETA: 0s - loss: 0.1326 - sparse_categorical_accuracy: 0.9607449/469 [===========================>..] - ETA: 0s - loss: 0.1319 - sparse_categorical_accuracy: 0.9608
Epoch 2: val_loss improved from 0.15474 to 0.11128, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1312 - sparse_categorical_accuracy: 0.9610 - val_loss: 0.1113 - val_sparse_categorical_accuracy: 0.9662
Epoch 3/20
  1/469 [..............................] - ETA: 13s - loss: 0.0579 - sparse_categorical_accuracy: 0.9766 48/469 [==>...........................] - ETA: 0s - loss: 0.0957 - sparse_categorical_accuracy: 0.9741  96/469 [=====>........................] - ETA: 0s - loss: 0.0939 - sparse_categorical_accuracy: 0.9722138/469 [=======>......................] - ETA: 0s - loss: 0.0937 - sparse_categorical_accuracy: 0.9714182/469 [==========>...................] - ETA: 0s - loss: 0.0961 - sparse_categorical_accuracy: 0.9702221/469 [=============>................] - ETA: 0s - loss: 0.0950 - sparse_categorical_accuracy: 0.9706267/469 [================>.............] - ETA: 0s - loss: 0.0943 - sparse_categorical_accuracy: 0.9712317/469 [===================>..........] - ETA: 0s - loss: 0.0931 - sparse_categorical_accuracy: 0.9714364/469 [======================>.......] - ETA: 0s - loss: 0.0933 - sparse_categorical_accuracy: 0.9716404/469 [========================>.....] - ETA: 0s - loss: 0.0923 - sparse_categorical_accuracy: 0.9715447/469 [===========================>..] - ETA: 0s - loss: 0.0922 - sparse_categorical_accuracy: 0.9718
Epoch 3: val_loss improved from 0.11128 to 0.10396, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.0916 - sparse_categorical_accuracy: 0.9720 - val_loss: 0.1040 - val_sparse_categorical_accuracy: 0.9682
Epoch 4/20
  1/469 [..............................] - ETA: 13s - loss: 0.0391 - sparse_categorical_accuracy: 0.9844 44/469 [=>............................] - ETA: 0s - loss: 0.0689 - sparse_categorical_accuracy: 0.9760  80/469 [====>.........................] - ETA: 0s - loss: 0.0671 - sparse_categorical_accuracy: 0.9784119/469 [======>.......................] - ETA: 0s - loss: 0.0706 - sparse_categorical_accuracy: 0.9775157/469 [=========>....................] - ETA: 0s - loss: 0.0709 - sparse_categorical_accuracy: 0.9779197/469 [===========>..................] - ETA: 0s - loss: 0.0717 - sparse_categorical_accuracy: 0.9774236/469 [==============>...............] - ETA: 0s - loss: 0.0731 - sparse_categorical_accuracy: 0.9774275/469 [================>.............] - ETA: 0s - loss: 0.0713 - sparse_categorical_accuracy: 0.9775312/469 [==================>...........] - ETA: 0s - loss: 0.0705 - sparse_categorical_accuracy: 0.9778350/469 [=====================>........] - ETA: 0s - loss: 0.0701 - sparse_categorical_accuracy: 0.9778386/469 [=======================>......] - ETA: 0s - loss: 0.0710 - sparse_categorical_accuracy: 0.9777425/469 [==========================>...] - ETA: 0s - loss: 0.0708 - sparse_categorical_accuracy: 0.9779466/469 [============================>.] - ETA: 0s - loss: 0.0716 - sparse_categorical_accuracy: 0.9777
Epoch 4: val_loss did not improve from 0.10396
469/469 [==============================] - 1s 1ms/step - loss: 0.0715 - sparse_categorical_accuracy: 0.9777 - val_loss: 0.1054 - val_sparse_categorical_accuracy: 0.9678
Epoch 5/20
  1/469 [..............................] - ETA: 12s - loss: 0.0696 - sparse_categorical_accuracy: 0.9766 48/469 [==>...........................] - ETA: 0s - loss: 0.0481 - sparse_categorical_accuracy: 0.9834  90/469 [====>.........................] - ETA: 0s - loss: 0.0513 - sparse_categorical_accuracy: 0.9822130/469 [=======>......................] - ETA: 0s - loss: 0.0521 - sparse_categorical_accuracy: 0.9826166/469 [=========>....................] - ETA: 0s - loss: 0.0528 - sparse_categorical_accuracy: 0.9826203/469 [===========>..................] - ETA: 0s - loss: 0.0541 - sparse_categorical_accuracy: 0.9822243/469 [==============>...............] - ETA: 0s - loss: 0.0553 - sparse_categorical_accuracy: 0.9819285/469 [=================>............] - ETA: 0s - loss: 0.0557 - sparse_categorical_accuracy: 0.9818331/469 [====================>.........] - ETA: 0s - loss: 0.0550 - sparse_categorical_accuracy: 0.9821379/469 [=======================>......] - ETA: 0s - loss: 0.0561 - sparse_categorical_accuracy: 0.9820420/469 [=========================>....] - ETA: 0s - loss: 0.0564 - sparse_categorical_accuracy: 0.9821458/469 [============================>.] - ETA: 0s - loss: 0.0572 - sparse_categorical_accuracy: 0.9820
Epoch 5: val_loss improved from 0.10396 to 0.08346, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.0571 - sparse_categorical_accuracy: 0.9822 - val_loss: 0.0835 - val_sparse_categorical_accuracy: 0.9748
Epoch 6/20
  1/469 [..............................] - ETA: 13s - loss: 0.0487 - sparse_categorical_accuracy: 0.9766 50/469 [==>...........................] - ETA: 0s - loss: 0.0476 - sparse_categorical_accuracy: 0.9866 100/469 [=====>........................] - ETA: 0s - loss: 0.0453 - sparse_categorical_accuracy: 0.9866139/469 [=======>......................] - ETA: 0s - loss: 0.0458 - sparse_categorical_accuracy: 0.9861178/469 [==========>...................] - ETA: 0s - loss: 0.0458 - sparse_categorical_accuracy: 0.9860224/469 [=============>................] - ETA: 0s - loss: 0.0477 - sparse_categorical_accuracy: 0.9851264/469 [===============>..............] - ETA: 0s - loss: 0.0477 - sparse_categorical_accuracy: 0.9851310/469 [==================>...........] - ETA: 0s - loss: 0.0489 - sparse_categorical_accuracy: 0.9847360/469 [======================>.......] - ETA: 0s - loss: 0.0483 - sparse_categorical_accuracy: 0.9846398/469 [========================>.....] - ETA: 0s - loss: 0.0481 - sparse_categorical_accuracy: 0.9848436/469 [==========================>...] - ETA: 0s - loss: 0.0478 - sparse_categorical_accuracy: 0.9850
Epoch 6: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0480 - sparse_categorical_accuracy: 0.9851 - val_loss: 0.0886 - val_sparse_categorical_accuracy: 0.9744
Epoch 7/20
  1/469 [..............................] - ETA: 13s - loss: 0.0462 - sparse_categorical_accuracy: 0.9844 48/469 [==>...........................] - ETA: 0s - loss: 0.0335 - sparse_categorical_accuracy: 0.9899  98/469 [=====>........................] - ETA: 0s - loss: 0.0332 - sparse_categorical_accuracy: 0.9902142/469 [========>.....................] - ETA: 0s - loss: 0.0306 - sparse_categorical_accuracy: 0.9911191/469 [===========>..................] - ETA: 0s - loss: 0.0321 - sparse_categorical_accuracy: 0.9906240/469 [==============>...............] - ETA: 0s - loss: 0.0339 - sparse_categorical_accuracy: 0.9897280/469 [================>.............] - ETA: 0s - loss: 0.0341 - sparse_categorical_accuracy: 0.9894323/469 [===================>..........] - ETA: 0s - loss: 0.0352 - sparse_categorical_accuracy: 0.9887364/469 [======================>.......] - ETA: 0s - loss: 0.0366 - sparse_categorical_accuracy: 0.9881402/469 [========================>.....] - ETA: 0s - loss: 0.0386 - sparse_categorical_accuracy: 0.9874447/469 [===========================>..] - ETA: 0s - loss: 0.0395 - sparse_categorical_accuracy: 0.9871
Epoch 7: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0394 - sparse_categorical_accuracy: 0.9871 - val_loss: 0.0877 - val_sparse_categorical_accuracy: 0.9740
Epoch 8/20
  1/469 [..............................] - ETA: 13s - loss: 0.0322 - sparse_categorical_accuracy: 0.9922 47/469 [==>...........................] - ETA: 0s - loss: 0.0264 - sparse_categorical_accuracy: 0.9912  91/469 [====>.........................] - ETA: 0s - loss: 0.0237 - sparse_categorical_accuracy: 0.9921134/469 [=======>......................] - ETA: 0s - loss: 0.0239 - sparse_categorical_accuracy: 0.9922182/469 [==========>...................] - ETA: 0s - loss: 0.0250 - sparse_categorical_accuracy: 0.9920231/469 [=============>................] - ETA: 0s - loss: 0.0266 - sparse_categorical_accuracy: 0.9915281/469 [================>.............] - ETA: 0s - loss: 0.0281 - sparse_categorical_accuracy: 0.9910319/469 [===================>..........] - ETA: 0s - loss: 0.0301 - sparse_categorical_accuracy: 0.9903351/469 [=====================>........] - ETA: 0s - loss: 0.0310 - sparse_categorical_accuracy: 0.9899383/469 [=======================>......] - ETA: 0s - loss: 0.0319 - sparse_categorical_accuracy: 0.9898422/469 [=========================>....] - ETA: 0s - loss: 0.0325 - sparse_categorical_accuracy: 0.9896463/469 [============================>.] - ETA: 0s - loss: 0.0327 - sparse_categorical_accuracy: 0.9895
Epoch 8: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0328 - sparse_categorical_accuracy: 0.9895 - val_loss: 0.0911 - val_sparse_categorical_accuracy: 0.9753
Epoch 9/20
  1/469 [..............................] - ETA: 13s - loss: 0.0170 - sparse_categorical_accuracy: 1.0000 43/469 [=>............................] - ETA: 0s - loss: 0.0202 - sparse_categorical_accuracy: 0.9940  81/469 [====>.........................] - ETA: 0s - loss: 0.0237 - sparse_categorical_accuracy: 0.9926121/469 [======>.......................] - ETA: 0s - loss: 0.0238 - sparse_categorical_accuracy: 0.9930162/469 [=========>....................] - ETA: 0s - loss: 0.0248 - sparse_categorical_accuracy: 0.9923205/469 [============>.................] - ETA: 0s - loss: 0.0253 - sparse_categorical_accuracy: 0.9922250/469 [==============>...............] - ETA: 0s - loss: 0.0264 - sparse_categorical_accuracy: 0.9918298/469 [==================>...........] - ETA: 0s - loss: 0.0267 - sparse_categorical_accuracy: 0.9916345/469 [=====================>........] - ETA: 0s - loss: 0.0273 - sparse_categorical_accuracy: 0.9914389/469 [=======================>......] - ETA: 0s - loss: 0.0270 - sparse_categorical_accuracy: 0.9916437/469 [==========================>...] - ETA: 0s - loss: 0.0276 - sparse_categorical_accuracy: 0.9915
Epoch 9: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0278 - sparse_categorical_accuracy: 0.9914 - val_loss: 0.0959 - val_sparse_categorical_accuracy: 0.9731
Epoch 10/20
  1/469 [..............................] - ETA: 12s - loss: 0.0184 - sparse_categorical_accuracy: 0.9922 48/469 [==>...........................] - ETA: 0s - loss: 0.0196 - sparse_categorical_accuracy: 0.9937  96/469 [=====>........................] - ETA: 0s - loss: 0.0223 - sparse_categorical_accuracy: 0.9928145/469 [========>.....................] - ETA: 0s - loss: 0.0241 - sparse_categorical_accuracy: 0.9922185/469 [==========>...................] - ETA: 0s - loss: 0.0236 - sparse_categorical_accuracy: 0.9923225/469 [=============>................] - ETA: 0s - loss: 0.0247 - sparse_categorical_accuracy: 0.9920262/469 [===============>..............] - ETA: 0s - loss: 0.0247 - sparse_categorical_accuracy: 0.9918301/469 [==================>...........] - ETA: 0s - loss: 0.0244 - sparse_categorical_accuracy: 0.9920345/469 [=====================>........] - ETA: 0s - loss: 0.0251 - sparse_categorical_accuracy: 0.9916383/469 [=======================>......] - ETA: 0s - loss: 0.0255 - sparse_categorical_accuracy: 0.9915419/469 [=========================>....] - ETA: 0s - loss: 0.0260 - sparse_categorical_accuracy: 0.9913455/469 [============================>.] - ETA: 0s - loss: 0.0258 - sparse_categorical_accuracy: 0.9914
Epoch 10: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0257 - sparse_categorical_accuracy: 0.9914 - val_loss: 0.0931 - val_sparse_categorical_accuracy: 0.9746
Epoch 11/20
  1/469 [..............................] - ETA: 13s - loss: 0.0079 - sparse_categorical_accuracy: 1.0000 49/469 [==>...........................] - ETA: 0s - loss: 0.0184 - sparse_categorical_accuracy: 0.9939  88/469 [====>.........................] - ETA: 0s - loss: 0.0216 - sparse_categorical_accuracy: 0.9925125/469 [======>.......................] - ETA: 0s - loss: 0.0209 - sparse_categorical_accuracy: 0.9929164/469 [=========>....................] - ETA: 0s - loss: 0.0194 - sparse_categorical_accuracy: 0.9935202/469 [===========>..................] - ETA: 0s - loss: 0.0193 - sparse_categorical_accuracy: 0.9934242/469 [==============>...............] - ETA: 0s - loss: 0.0195 - sparse_categorical_accuracy: 0.9935284/469 [=================>............] - ETA: 0s - loss: 0.0195 - sparse_categorical_accuracy: 0.9936324/469 [===================>..........] - ETA: 0s - loss: 0.0194 - sparse_categorical_accuracy: 0.9935365/469 [======================>.......] - ETA: 0s - loss: 0.0194 - sparse_categorical_accuracy: 0.9937408/469 [=========================>....] - ETA: 0s - loss: 0.0198 - sparse_categorical_accuracy: 0.9935448/469 [===========================>..] - ETA: 0s - loss: 0.0205 - sparse_categorical_accuracy: 0.9932
Epoch 11: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0207 - sparse_categorical_accuracy: 0.9931 - val_loss: 0.0848 - val_sparse_categorical_accuracy: 0.9784
Epoch 12/20
  1/469 [..............................] - ETA: 13s - loss: 0.0061 - sparse_categorical_accuracy: 1.0000 47/469 [==>...........................] - ETA: 0s - loss: 0.0207 - sparse_categorical_accuracy: 0.9932  87/469 [====>.........................] - ETA: 0s - loss: 0.0176 - sparse_categorical_accuracy: 0.9943128/469 [=======>......................] - ETA: 0s - loss: 0.0175 - sparse_categorical_accuracy: 0.9944167/469 [=========>....................] - ETA: 0s - loss: 0.0173 - sparse_categorical_accuracy: 0.9945213/469 [============>.................] - ETA: 0s - loss: 0.0164 - sparse_categorical_accuracy: 0.9948263/469 [===============>..............] - ETA: 0s - loss: 0.0158 - sparse_categorical_accuracy: 0.9950311/469 [==================>...........] - ETA: 0s - loss: 0.0162 - sparse_categorical_accuracy: 0.9946357/469 [=====================>........] - ETA: 0s - loss: 0.0174 - sparse_categorical_accuracy: 0.9941398/469 [========================>.....] - ETA: 0s - loss: 0.0184 - sparse_categorical_accuracy: 0.9937438/469 [===========================>..] - ETA: 0s - loss: 0.0186 - sparse_categorical_accuracy: 0.9937
Epoch 12: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0193 - sparse_categorical_accuracy: 0.9934 - val_loss: 0.0970 - val_sparse_categorical_accuracy: 0.9739
Epoch 13/20
  1/469 [..............................] - ETA: 13s - loss: 0.0102 - sparse_categorical_accuracy: 1.0000 48/469 [==>...........................] - ETA: 0s - loss: 0.0182 - sparse_categorical_accuracy: 0.9948  88/469 [====>.........................] - ETA: 0s - loss: 0.0183 - sparse_categorical_accuracy: 0.9937127/469 [=======>......................] - ETA: 0s - loss: 0.0173 - sparse_categorical_accuracy: 0.9943166/469 [=========>....................] - ETA: 0s - loss: 0.0171 - sparse_categorical_accuracy: 0.9941205/469 [============>.................] - ETA: 0s - loss: 0.0176 - sparse_categorical_accuracy: 0.9941248/469 [==============>...............] - ETA: 0s - loss: 0.0171 - sparse_categorical_accuracy: 0.9940288/469 [=================>............] - ETA: 0s - loss: 0.0169 - sparse_categorical_accuracy: 0.9941326/469 [===================>..........] - ETA: 0s - loss: 0.0173 - sparse_categorical_accuracy: 0.9941365/469 [======================>.......] - ETA: 0s - loss: 0.0178 - sparse_categorical_accuracy: 0.9940404/469 [========================>.....] - ETA: 0s - loss: 0.0183 - sparse_categorical_accuracy: 0.9938444/469 [===========================>..] - ETA: 0s - loss: 0.0183 - sparse_categorical_accuracy: 0.9938
Epoch 13: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0184 - sparse_categorical_accuracy: 0.9939 - val_loss: 0.1027 - val_sparse_categorical_accuracy: 0.9748
Epoch 14/20
  1/469 [..............................] - ETA: 12s - loss: 0.0046 - sparse_categorical_accuracy: 1.0000 50/469 [==>...........................] - ETA: 0s - loss: 0.0123 - sparse_categorical_accuracy: 0.9956  99/469 [=====>........................] - ETA: 0s - loss: 0.0106 - sparse_categorical_accuracy: 0.9967143/469 [========>.....................] - ETA: 0s - loss: 0.0118 - sparse_categorical_accuracy: 0.9961181/469 [==========>...................] - ETA: 0s - loss: 0.0135 - sparse_categorical_accuracy: 0.9956220/469 [=============>................] - ETA: 0s - loss: 0.0132 - sparse_categorical_accuracy: 0.9956257/469 [===============>..............] - ETA: 0s - loss: 0.0142 - sparse_categorical_accuracy: 0.9953294/469 [=================>............] - ETA: 0s - loss: 0.0138 - sparse_categorical_accuracy: 0.9954332/469 [====================>.........] - ETA: 0s - loss: 0.0135 - sparse_categorical_accuracy: 0.9956371/469 [======================>.......] - ETA: 0s - loss: 0.0135 - sparse_categorical_accuracy: 0.9955412/469 [=========================>....] - ETA: 0s - loss: 0.0137 - sparse_categorical_accuracy: 0.9954451/469 [===========================>..] - ETA: 0s - loss: 0.0138 - sparse_categorical_accuracy: 0.9953
Epoch 14: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0139 - sparse_categorical_accuracy: 0.9953 - val_loss: 0.1076 - val_sparse_categorical_accuracy: 0.9759
Epoch 15/20
  1/469 [..............................] - ETA: 13s - loss: 0.0018 - sparse_categorical_accuracy: 1.0000 47/469 [==>...........................] - ETA: 0s - loss: 0.0080 - sparse_categorical_accuracy: 0.9978  90/469 [====>.........................] - ETA: 0s - loss: 0.0072 - sparse_categorical_accuracy: 0.9984132/469 [=======>......................] - ETA: 0s - loss: 0.0072 - sparse_categorical_accuracy: 0.9983173/469 [==========>...................] - ETA: 0s - loss: 0.0071 - sparse_categorical_accuracy: 0.9982216/469 [============>.................] - ETA: 0s - loss: 0.0077 - sparse_categorical_accuracy: 0.9980262/469 [===============>..............] - ETA: 0s - loss: 0.0091 - sparse_categorical_accuracy: 0.9976304/469 [==================>...........] - ETA: 0s - loss: 0.0105 - sparse_categorical_accuracy: 0.9971347/469 [=====================>........] - ETA: 0s - loss: 0.0114 - sparse_categorical_accuracy: 0.9968387/469 [=======================>......] - ETA: 0s - loss: 0.0119 - sparse_categorical_accuracy: 0.9966426/469 [==========================>...] - ETA: 0s - loss: 0.0123 - sparse_categorical_accuracy: 0.9964468/469 [============================>.] - ETA: 0s - loss: 0.0128 - sparse_categorical_accuracy: 0.9962
Epoch 15: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0129 - sparse_categorical_accuracy: 0.9962 - val_loss: 0.1051 - val_sparse_categorical_accuracy: 0.9753
Epoch 16/20
  1/469 [..............................] - ETA: 12s - loss: 0.0032 - sparse_categorical_accuracy: 1.0000 44/469 [=>............................] - ETA: 0s - loss: 0.0160 - sparse_categorical_accuracy: 0.9943  90/469 [====>.........................] - ETA: 0s - loss: 0.0124 - sparse_categorical_accuracy: 0.9962134/469 [=======>......................] - ETA: 0s - loss: 0.0105 - sparse_categorical_accuracy: 0.9969176/469 [==========>...................] - ETA: 0s - loss: 0.0100 - sparse_categorical_accuracy: 0.9971218/469 [============>.................] - ETA: 0s - loss: 0.0098 - sparse_categorical_accuracy: 0.9969261/469 [===============>..............] - ETA: 0s - loss: 0.0105 - sparse_categorical_accuracy: 0.9966301/469 [==================>...........] - ETA: 0s - loss: 0.0112 - sparse_categorical_accuracy: 0.9963338/469 [====================>.........] - ETA: 0s - loss: 0.0117 - sparse_categorical_accuracy: 0.9961374/469 [======================>.......] - ETA: 0s - loss: 0.0119 - sparse_categorical_accuracy: 0.9961415/469 [=========================>....] - ETA: 0s - loss: 0.0122 - sparse_categorical_accuracy: 0.9960457/469 [============================>.] - ETA: 0s - loss: 0.0124 - sparse_categorical_accuracy: 0.9957
Epoch 16: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0125 - sparse_categorical_accuracy: 0.9957 - val_loss: 0.0995 - val_sparse_categorical_accuracy: 0.9769
Epoch 17/20
  1/469 [..............................] - ETA: 12s - loss: 0.0060 - sparse_categorical_accuracy: 1.0000 50/469 [==>...........................] - ETA: 0s - loss: 0.0133 - sparse_categorical_accuracy: 0.9952  98/469 [=====>........................] - ETA: 0s - loss: 0.0126 - sparse_categorical_accuracy: 0.9955147/469 [========>.....................] - ETA: 0s - loss: 0.0116 - sparse_categorical_accuracy: 0.9960186/469 [==========>...................] - ETA: 0s - loss: 0.0115 - sparse_categorical_accuracy: 0.9961224/469 [=============>................] - ETA: 0s - loss: 0.0119 - sparse_categorical_accuracy: 0.9961263/469 [===============>..............] - ETA: 0s - loss: 0.0117 - sparse_categorical_accuracy: 0.9961308/469 [==================>...........] - ETA: 0s - loss: 0.0121 - sparse_categorical_accuracy: 0.9959354/469 [=====================>........] - ETA: 0s - loss: 0.0119 - sparse_categorical_accuracy: 0.9959401/469 [========================>.....] - ETA: 0s - loss: 0.0121 - sparse_categorical_accuracy: 0.9959446/469 [===========================>..] - ETA: 0s - loss: 0.0119 - sparse_categorical_accuracy: 0.9960
Epoch 17: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0121 - sparse_categorical_accuracy: 0.9959 - val_loss: 0.1023 - val_sparse_categorical_accuracy: 0.9769
Epoch 18/20
  1/469 [..............................] - ETA: 13s - loss: 0.0127 - sparse_categorical_accuracy: 0.9922 48/469 [==>...........................] - ETA: 0s - loss: 0.0108 - sparse_categorical_accuracy: 0.9966  95/469 [=====>........................] - ETA: 0s - loss: 0.0098 - sparse_categorical_accuracy: 0.9969141/469 [========>.....................] - ETA: 0s - loss: 0.0087 - sparse_categorical_accuracy: 0.9973183/469 [==========>...................] - ETA: 0s - loss: 0.0082 - sparse_categorical_accuracy: 0.9975221/469 [=============>................] - ETA: 0s - loss: 0.0083 - sparse_categorical_accuracy: 0.9973262/469 [===============>..............] - ETA: 0s - loss: 0.0078 - sparse_categorical_accuracy: 0.9976305/469 [==================>...........] - ETA: 0s - loss: 0.0079 - sparse_categorical_accuracy: 0.9976352/469 [=====================>........] - ETA: 0s - loss: 0.0082 - sparse_categorical_accuracy: 0.9974400/469 [========================>.....] - ETA: 0s - loss: 0.0086 - sparse_categorical_accuracy: 0.9973448/469 [===========================>..] - ETA: 0s - loss: 0.0084 - sparse_categorical_accuracy: 0.9974
Epoch 18: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0086 - sparse_categorical_accuracy: 0.9973 - val_loss: 0.1169 - val_sparse_categorical_accuracy: 0.9756
Epoch 19/20
  1/469 [..............................] - ETA: 13s - loss: 0.0467 - sparse_categorical_accuracy: 0.9922 49/469 [==>...........................] - ETA: 0s - loss: 0.0117 - sparse_categorical_accuracy: 0.9968  84/469 [====>.........................] - ETA: 0s - loss: 0.0129 - sparse_categorical_accuracy: 0.9959118/469 [======>.......................] - ETA: 0s - loss: 0.0131 - sparse_categorical_accuracy: 0.9955155/469 [========>.....................] - ETA: 0s - loss: 0.0144 - sparse_categorical_accuracy: 0.9950192/469 [===========>..................] - ETA: 0s - loss: 0.0142 - sparse_categorical_accuracy: 0.9949229/469 [=============>................] - ETA: 0s - loss: 0.0140 - sparse_categorical_accuracy: 0.9951267/469 [================>.............] - ETA: 0s - loss: 0.0134 - sparse_categorical_accuracy: 0.9953311/469 [==================>...........] - ETA: 0s - loss: 0.0129 - sparse_categorical_accuracy: 0.9954353/469 [=====================>........] - ETA: 0s - loss: 0.0127 - sparse_categorical_accuracy: 0.9954395/469 [========================>.....] - ETA: 0s - loss: 0.0129 - sparse_categorical_accuracy: 0.9953439/469 [===========================>..] - ETA: 0s - loss: 0.0128 - sparse_categorical_accuracy: 0.9953
Epoch 19: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0128 - sparse_categorical_accuracy: 0.9953 - val_loss: 0.1130 - val_sparse_categorical_accuracy: 0.9767
Epoch 20/20
  1/469 [..............................] - ETA: 14s - loss: 0.0032 - sparse_categorical_accuracy: 1.0000 47/469 [==>...........................] - ETA: 0s - loss: 0.0101 - sparse_categorical_accuracy: 0.9962  96/469 [=====>........................] - ETA: 0s - loss: 0.0085 - sparse_categorical_accuracy: 0.9967138/469 [=======>......................] - ETA: 0s - loss: 0.0074 - sparse_categorical_accuracy: 0.9973177/469 [==========>...................] - ETA: 0s - loss: 0.0075 - sparse_categorical_accuracy: 0.9974215/469 [============>.................] - ETA: 0s - loss: 0.0075 - sparse_categorical_accuracy: 0.9974252/469 [===============>..............] - ETA: 0s - loss: 0.0073 - sparse_categorical_accuracy: 0.9974297/469 [=================>............] - ETA: 0s - loss: 0.0076 - sparse_categorical_accuracy: 0.9974340/469 [====================>.........] - ETA: 0s - loss: 0.0075 - sparse_categorical_accuracy: 0.9974383/469 [=======================>......] - ETA: 0s - loss: 0.0075 - sparse_categorical_accuracy: 0.9974421/469 [=========================>....] - ETA: 0s - loss: 0.0077 - sparse_categorical_accuracy: 0.9973458/469 [============================>.] - ETA: 0s - loss: 0.0083 - sparse_categorical_accuracy: 0.9972
Epoch 20: val_loss did not improve from 0.08346
469/469 [==============================] - 1s 1ms/step - loss: 0.0085 - sparse_categorical_accuracy: 0.9971 - val_loss: 0.1216 - val_sparse_categorical_accuracy: 0.9758
Evaluting model with ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f2030735b90> has ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f20306da3d0> has ber = 1.0
 1/79 [..............................] - ETA: 1s - loss: 0.0984 - sparse_categorical_accuracy: 0.984462/79 [======================>.......] - ETA: 0s - loss: 0.1238 - sparse_categorical_accuracy: 0.975679/79 [==============================] - 0s 835us/step - loss: 0.1216 - sparse_categorical_accuracy: 0.9758

2022-08-23 10:59:22.710784: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:59:22.713997: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:59:22.714317: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:59:22.714814: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-08-23 10:59:22.715493: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:59:22.715790: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:59:22.716073: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:59:23.004466: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:59:23.004747: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:59:23.004994: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:59:23.005242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 6534 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1070, pci bus id: 0000:0a:00.0, compute capability: 6.1
Logit total bits = 2, int bits = 1
Activation total bits = 2, int bits = 1
<keras.engine.functional.Functional object at 0x7fc46c45edd0>
#################
# MODEL SUMMARY #
#################
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 28, 28)]          0         
                                                                 
 flatten (Flatten)           (None, 784)               0         
                                                                 
 fq_dense (FQDense)          (None, 128)               100480    
                                                                 
 q_activation_1 (QActivation  (None, 128)              0         
 )                                                               
                                                                 
 fq_dense_1 (FQDense)        (None, 10)                1290      
                                                                 
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
None
#################
Training with ber = 0.0
Layer <fkeras.fdense.FQDense object at 0x7fc46c31c290> has ber = 0.0
Layer <fkeras.fdense.FQDense object at 0x7fc46c39a750> has ber = 0.0
Epoch 1/20
  1/469 [..............................] - ETA: 8:56 - loss: 17.0873 - sparse_categorical_accuracy: 0.1094 41/469 [=>............................] - ETA: 0s - loss: 10.1052 - sparse_categorical_accuracy: 0.1843   79/469 [====>.........................] - ETA: 0s - loss: 7.6428 - sparse_categorical_accuracy: 0.2807 114/469 [======>.......................] - ETA: 0s - loss: 6.3605 - sparse_categorical_accuracy: 0.3545152/469 [========>.....................] - ETA: 0s - loss: 5.4867 - sparse_categorical_accuracy: 0.4122191/469 [===========>..................] - ETA: 0s - loss: 4.8577 - sparse_categorical_accuracy: 0.4595230/469 [=============>................] - ETA: 0s - loss: 4.3929 - sparse_categorical_accuracy: 0.4962268/469 [================>.............] - ETA: 0s - loss: 4.0665 - sparse_categorical_accuracy: 0.5234303/469 [==================>...........] - ETA: 0s - loss: 3.8114 - sparse_categorical_accuracy: 0.5443337/469 [====================>.........] - ETA: 0s - loss: 3.5953 - sparse_categorical_accuracy: 0.5628370/469 [======================>.......] - ETA: 0s - loss: 3.4159 - sparse_categorical_accuracy: 0.5790404/469 [========================>.....] - ETA: 0s - loss: 3.2621 - sparse_categorical_accuracy: 0.5930442/469 [===========================>..] - ETA: 0s - loss: 3.1029 - sparse_categorical_accuracy: 0.6075
Epoch 1: val_loss improved from inf to 1.32954, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 2s 2ms/step - loss: 3.0020 - sparse_categorical_accuracy: 0.6164 - val_loss: 1.3295 - val_sparse_categorical_accuracy: 0.7716
Epoch 2/20
  1/469 [..............................] - ETA: 13s - loss: 0.6440 - sparse_categorical_accuracy: 0.8281 41/469 [=>............................] - ETA: 0s - loss: 1.3872 - sparse_categorical_accuracy: 0.7637  85/469 [====>.........................] - ETA: 0s - loss: 1.3553 - sparse_categorical_accuracy: 0.7723130/469 [=======>......................] - ETA: 0s - loss: 1.3309 - sparse_categorical_accuracy: 0.7757175/469 [==========>...................] - ETA: 0s - loss: 1.2957 - sparse_categorical_accuracy: 0.7811218/469 [============>.................] - ETA: 0s - loss: 1.2516 - sparse_categorical_accuracy: 0.7871261/469 [===============>..............] - ETA: 0s - loss: 1.2323 - sparse_categorical_accuracy: 0.7909308/469 [==================>...........] - ETA: 0s - loss: 1.2004 - sparse_categorical_accuracy: 0.7949355/469 [=====================>........] - ETA: 0s - loss: 1.1839 - sparse_categorical_accuracy: 0.7965398/469 [========================>.....] - ETA: 0s - loss: 1.1697 - sparse_categorical_accuracy: 0.7994440/469 [===========================>..] - ETA: 0s - loss: 1.1544 - sparse_categorical_accuracy: 0.8018
Epoch 2: val_loss improved from 1.32954 to 0.94089, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 1.1403 - sparse_categorical_accuracy: 0.8042 - val_loss: 0.9409 - val_sparse_categorical_accuracy: 0.8318
Epoch 3/20
  1/469 [..............................] - ETA: 12s - loss: 0.8967 - sparse_categorical_accuracy: 0.8828 49/469 [==>...........................] - ETA: 0s - loss: 0.9897 - sparse_categorical_accuracy: 0.8283  91/469 [====>.........................] - ETA: 0s - loss: 0.9834 - sparse_categorical_accuracy: 0.8286131/469 [=======>......................] - ETA: 0s - loss: 0.9671 - sparse_categorical_accuracy: 0.8300174/469 [==========>...................] - ETA: 0s - loss: 0.9417 - sparse_categorical_accuracy: 0.8318218/469 [============>.................] - ETA: 0s - loss: 0.9260 - sparse_categorical_accuracy: 0.8338263/469 [===============>..............] - ETA: 0s - loss: 0.9094 - sparse_categorical_accuracy: 0.8361304/469 [==================>...........] - ETA: 0s - loss: 0.8989 - sparse_categorical_accuracy: 0.8371350/469 [=====================>........] - ETA: 0s - loss: 0.8977 - sparse_categorical_accuracy: 0.8370389/469 [=======================>......] - ETA: 0s - loss: 0.8931 - sparse_categorical_accuracy: 0.8378431/469 [==========================>...] - ETA: 0s - loss: 0.8873 - sparse_categorical_accuracy: 0.8383
Epoch 3: val_loss improved from 0.94089 to 0.89617, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.8827 - sparse_categorical_accuracy: 0.8392 - val_loss: 0.8962 - val_sparse_categorical_accuracy: 0.8371
Epoch 4/20
  1/469 [..............................] - ETA: 13s - loss: 0.9405 - sparse_categorical_accuracy: 0.8281 48/469 [==>...........................] - ETA: 0s - loss: 0.8035 - sparse_categorical_accuracy: 0.8553  89/469 [====>.........................] - ETA: 0s - loss: 0.8091 - sparse_categorical_accuracy: 0.8517134/469 [=======>......................] - ETA: 0s - loss: 0.8005 - sparse_categorical_accuracy: 0.8514181/469 [==========>...................] - ETA: 0s - loss: 0.7913 - sparse_categorical_accuracy: 0.8523230/469 [=============>................] - ETA: 0s - loss: 0.7771 - sparse_categorical_accuracy: 0.8536276/469 [================>.............] - ETA: 0s - loss: 0.7840 - sparse_categorical_accuracy: 0.8546323/469 [===================>..........] - ETA: 0s - loss: 0.7785 - sparse_categorical_accuracy: 0.8551370/469 [======================>.......] - ETA: 0s - loss: 0.7696 - sparse_categorical_accuracy: 0.8569412/469 [=========================>....] - ETA: 0s - loss: 0.7696 - sparse_categorical_accuracy: 0.8567460/469 [============================>.] - ETA: 0s - loss: 0.7635 - sparse_categorical_accuracy: 0.8577
Epoch 4: val_loss improved from 0.89617 to 0.70232, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.7659 - sparse_categorical_accuracy: 0.8574 - val_loss: 0.7023 - val_sparse_categorical_accuracy: 0.8733
Epoch 5/20
  1/469 [..............................] - ETA: 12s - loss: 0.5073 - sparse_categorical_accuracy: 0.8750 49/469 [==>...........................] - ETA: 0s - loss: 0.7270 - sparse_categorical_accuracy: 0.8678  94/469 [=====>........................] - ETA: 0s - loss: 0.6954 - sparse_categorical_accuracy: 0.8679138/469 [=======>......................] - ETA: 0s - loss: 0.7058 - sparse_categorical_accuracy: 0.8658181/469 [==========>...................] - ETA: 0s - loss: 0.7071 - sparse_categorical_accuracy: 0.8655225/469 [=============>................] - ETA: 0s - loss: 0.7081 - sparse_categorical_accuracy: 0.8651262/469 [===============>..............] - ETA: 0s - loss: 0.7077 - sparse_categorical_accuracy: 0.8657301/469 [==================>...........] - ETA: 0s - loss: 0.7097 - sparse_categorical_accuracy: 0.8650346/469 [=====================>........] - ETA: 0s - loss: 0.7009 - sparse_categorical_accuracy: 0.8667390/469 [=======================>......] - ETA: 0s - loss: 0.7047 - sparse_categorical_accuracy: 0.8663433/469 [==========================>...] - ETA: 0s - loss: 0.6989 - sparse_categorical_accuracy: 0.8676
Epoch 5: val_loss did not improve from 0.70232
469/469 [==============================] - 1s 1ms/step - loss: 0.6993 - sparse_categorical_accuracy: 0.8675 - val_loss: 0.7862 - val_sparse_categorical_accuracy: 0.8632
Epoch 6/20
  1/469 [..............................] - ETA: 13s - loss: 0.6665 - sparse_categorical_accuracy: 0.8828 44/469 [=>............................] - ETA: 0s - loss: 0.6538 - sparse_categorical_accuracy: 0.8725  88/469 [====>.........................] - ETA: 0s - loss: 0.6756 - sparse_categorical_accuracy: 0.8722129/469 [=======>......................] - ETA: 0s - loss: 0.6573 - sparse_categorical_accuracy: 0.8743171/469 [=========>....................] - ETA: 0s - loss: 0.6590 - sparse_categorical_accuracy: 0.8734215/469 [============>.................] - ETA: 0s - loss: 0.6651 - sparse_categorical_accuracy: 0.8727258/469 [===============>..............] - ETA: 0s - loss: 0.6573 - sparse_categorical_accuracy: 0.8737302/469 [==================>...........] - ETA: 0s - loss: 0.6476 - sparse_categorical_accuracy: 0.8756351/469 [=====================>........] - ETA: 0s - loss: 0.6546 - sparse_categorical_accuracy: 0.8753399/469 [========================>.....] - ETA: 0s - loss: 0.6502 - sparse_categorical_accuracy: 0.8763437/469 [==========================>...] - ETA: 0s - loss: 0.6504 - sparse_categorical_accuracy: 0.8761
Epoch 6: val_loss improved from 0.70232 to 0.65829, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.6483 - sparse_categorical_accuracy: 0.8763 - val_loss: 0.6583 - val_sparse_categorical_accuracy: 0.8764
Epoch 7/20
  1/469 [..............................] - ETA: 16s - loss: 0.4333 - sparse_categorical_accuracy: 0.8984 49/469 [==>...........................] - ETA: 0s - loss: 0.5475 - sparse_categorical_accuracy: 0.8903  89/469 [====>.........................] - ETA: 0s - loss: 0.5673 - sparse_categorical_accuracy: 0.8861130/469 [=======>......................] - ETA: 0s - loss: 0.5755 - sparse_categorical_accuracy: 0.8850178/469 [==========>...................] - ETA: 0s - loss: 0.5808 - sparse_categorical_accuracy: 0.8844220/469 [=============>................] - ETA: 0s - loss: 0.5830 - sparse_categorical_accuracy: 0.8846257/469 [===============>..............] - ETA: 0s - loss: 0.5737 - sparse_categorical_accuracy: 0.8860303/469 [==================>...........] - ETA: 0s - loss: 0.5841 - sparse_categorical_accuracy: 0.8859349/469 [=====================>........] - ETA: 0s - loss: 0.5876 - sparse_categorical_accuracy: 0.8859390/469 [=======================>......] - ETA: 0s - loss: 0.5842 - sparse_categorical_accuracy: 0.8864434/469 [==========================>...] - ETA: 0s - loss: 0.5878 - sparse_categorical_accuracy: 0.8859
Epoch 7: val_loss improved from 0.65829 to 0.62216, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.5902 - sparse_categorical_accuracy: 0.8859 - val_loss: 0.6222 - val_sparse_categorical_accuracy: 0.8859
Epoch 8/20
  1/469 [..............................] - ETA: 13s - loss: 0.7091 - sparse_categorical_accuracy: 0.8359 48/469 [==>...........................] - ETA: 0s - loss: 0.5367 - sparse_categorical_accuracy: 0.8940  97/469 [=====>........................] - ETA: 0s - loss: 0.5428 - sparse_categorical_accuracy: 0.8934147/469 [========>.....................] - ETA: 0s - loss: 0.5443 - sparse_categorical_accuracy: 0.8931197/469 [===========>..................] - ETA: 0s - loss: 0.5490 - sparse_categorical_accuracy: 0.8924248/469 [==============>...............] - ETA: 0s - loss: 0.5476 - sparse_categorical_accuracy: 0.8924296/469 [=================>............] - ETA: 0s - loss: 0.5516 - sparse_categorical_accuracy: 0.8923342/469 [====================>.........] - ETA: 0s - loss: 0.5549 - sparse_categorical_accuracy: 0.8921386/469 [=======================>......] - ETA: 0s - loss: 0.5632 - sparse_categorical_accuracy: 0.8911434/469 [==========================>...] - ETA: 0s - loss: 0.5654 - sparse_categorical_accuracy: 0.8907
Epoch 8: val_loss improved from 0.62216 to 0.57904, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.5711 - sparse_categorical_accuracy: 0.8902 - val_loss: 0.5790 - val_sparse_categorical_accuracy: 0.8897
Epoch 9/20
  1/469 [..............................] - ETA: 13s - loss: 0.4213 - sparse_categorical_accuracy: 0.9141 49/469 [==>...........................] - ETA: 0s - loss: 0.5561 - sparse_categorical_accuracy: 0.8924  88/469 [====>.........................] - ETA: 0s - loss: 0.5246 - sparse_categorical_accuracy: 0.8950128/469 [=======>......................] - ETA: 0s - loss: 0.5343 - sparse_categorical_accuracy: 0.8941168/469 [=========>....................] - ETA: 0s - loss: 0.5249 - sparse_categorical_accuracy: 0.8953208/469 [============>.................] - ETA: 0s - loss: 0.5288 - sparse_categorical_accuracy: 0.8955246/469 [==============>...............] - ETA: 0s - loss: 0.5331 - sparse_categorical_accuracy: 0.8943284/469 [=================>............] - ETA: 0s - loss: 0.5325 - sparse_categorical_accuracy: 0.8947323/469 [===================>..........] - ETA: 0s - loss: 0.5338 - sparse_categorical_accuracy: 0.8943361/469 [======================>.......] - ETA: 0s - loss: 0.5339 - sparse_categorical_accuracy: 0.8945393/469 [========================>.....] - ETA: 0s - loss: 0.5369 - sparse_categorical_accuracy: 0.8940428/469 [==========================>...] - ETA: 0s - loss: 0.5335 - sparse_categorical_accuracy: 0.8941461/469 [============================>.] - ETA: 0s - loss: 0.5360 - sparse_categorical_accuracy: 0.8936
Epoch 9: val_loss improved from 0.57904 to 0.50116, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 2ms/step - loss: 0.5359 - sparse_categorical_accuracy: 0.8935 - val_loss: 0.5012 - val_sparse_categorical_accuracy: 0.9003
Epoch 10/20
  1/469 [..............................] - ETA: 13s - loss: 0.6910 - sparse_categorical_accuracy: 0.8672 52/469 [==>...........................] - ETA: 0s - loss: 0.5392 - sparse_categorical_accuracy: 0.8939 104/469 [=====>........................] - ETA: 0s - loss: 0.5573 - sparse_categorical_accuracy: 0.8918144/469 [========>.....................] - ETA: 0s - loss: 0.5484 - sparse_categorical_accuracy: 0.8924185/469 [==========>...................] - ETA: 0s - loss: 0.5554 - sparse_categorical_accuracy: 0.8922231/469 [=============>................] - ETA: 0s - loss: 0.5542 - sparse_categorical_accuracy: 0.8932274/469 [================>.............] - ETA: 0s - loss: 0.5543 - sparse_categorical_accuracy: 0.8926316/469 [===================>..........] - ETA: 0s - loss: 0.5612 - sparse_categorical_accuracy: 0.8913358/469 [=====================>........] - ETA: 0s - loss: 0.5599 - sparse_categorical_accuracy: 0.8922403/469 [========================>.....] - ETA: 0s - loss: 0.5587 - sparse_categorical_accuracy: 0.8923451/469 [===========================>..] - ETA: 0s - loss: 0.5517 - sparse_categorical_accuracy: 0.8931
Epoch 10: val_loss improved from 0.50116 to 0.48602, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.5488 - sparse_categorical_accuracy: 0.8937 - val_loss: 0.4860 - val_sparse_categorical_accuracy: 0.9006
Epoch 11/20
  1/469 [..............................] - ETA: 14s - loss: 0.4938 - sparse_categorical_accuracy: 0.9141 46/469 [=>............................] - ETA: 0s - loss: 0.4830 - sparse_categorical_accuracy: 0.9003  93/469 [====>.........................] - ETA: 0s - loss: 0.4883 - sparse_categorical_accuracy: 0.8982141/469 [========>.....................] - ETA: 0s - loss: 0.5009 - sparse_categorical_accuracy: 0.8961191/469 [===========>..................] - ETA: 0s - loss: 0.5043 - sparse_categorical_accuracy: 0.8962229/469 [=============>................] - ETA: 0s - loss: 0.5150 - sparse_categorical_accuracy: 0.8956270/469 [================>.............] - ETA: 0s - loss: 0.5163 - sparse_categorical_accuracy: 0.8954318/469 [===================>..........] - ETA: 0s - loss: 0.5133 - sparse_categorical_accuracy: 0.8965360/469 [======================>.......] - ETA: 0s - loss: 0.5074 - sparse_categorical_accuracy: 0.8976409/469 [=========================>....] - ETA: 0s - loss: 0.5138 - sparse_categorical_accuracy: 0.8968451/469 [===========================>..] - ETA: 0s - loss: 0.5110 - sparse_categorical_accuracy: 0.8973
Epoch 11: val_loss improved from 0.48602 to 0.44747, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.5109 - sparse_categorical_accuracy: 0.8972 - val_loss: 0.4475 - val_sparse_categorical_accuracy: 0.9105
Epoch 12/20
  1/469 [..............................] - ETA: 13s - loss: 0.6174 - sparse_categorical_accuracy: 0.8984 51/469 [==>...........................] - ETA: 0s - loss: 0.4345 - sparse_categorical_accuracy: 0.9096  96/469 [=====>........................] - ETA: 0s - loss: 0.4280 - sparse_categorical_accuracy: 0.9097140/469 [=======>......................] - ETA: 0s - loss: 0.4333 - sparse_categorical_accuracy: 0.9080186/469 [==========>...................] - ETA: 0s - loss: 0.4428 - sparse_categorical_accuracy: 0.9068235/469 [==============>...............] - ETA: 0s - loss: 0.4510 - sparse_categorical_accuracy: 0.9054284/469 [=================>............] - ETA: 0s - loss: 0.4501 - sparse_categorical_accuracy: 0.9053332/469 [====================>.........] - ETA: 0s - loss: 0.4579 - sparse_categorical_accuracy: 0.9042380/469 [=======================>......] - ETA: 0s - loss: 0.4626 - sparse_categorical_accuracy: 0.9035429/469 [==========================>...] - ETA: 0s - loss: 0.4595 - sparse_categorical_accuracy: 0.9042
Epoch 12: val_loss improved from 0.44747 to 0.44685, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.4647 - sparse_categorical_accuracy: 0.9039 - val_loss: 0.4468 - val_sparse_categorical_accuracy: 0.9103
Epoch 13/20
  1/469 [..............................] - ETA: 12s - loss: 0.4842 - sparse_categorical_accuracy: 0.9062 51/469 [==>...........................] - ETA: 0s - loss: 0.4422 - sparse_categorical_accuracy: 0.9047  95/469 [=====>........................] - ETA: 0s - loss: 0.4537 - sparse_categorical_accuracy: 0.9037141/469 [========>.....................] - ETA: 0s - loss: 0.4566 - sparse_categorical_accuracy: 0.9066184/469 [==========>...................] - ETA: 0s - loss: 0.4590 - sparse_categorical_accuracy: 0.9056230/469 [=============>................] - ETA: 0s - loss: 0.4592 - sparse_categorical_accuracy: 0.9062271/469 [================>.............] - ETA: 0s - loss: 0.4659 - sparse_categorical_accuracy: 0.9068319/469 [===================>..........] - ETA: 0s - loss: 0.4708 - sparse_categorical_accuracy: 0.9066368/469 [======================>.......] - ETA: 0s - loss: 0.4718 - sparse_categorical_accuracy: 0.9069409/469 [=========================>....] - ETA: 0s - loss: 0.4702 - sparse_categorical_accuracy: 0.9069449/469 [===========================>..] - ETA: 0s - loss: 0.4661 - sparse_categorical_accuracy: 0.9075
Epoch 13: val_loss improved from 0.44685 to 0.41339, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.4662 - sparse_categorical_accuracy: 0.9075 - val_loss: 0.4134 - val_sparse_categorical_accuracy: 0.9178
Epoch 14/20
  1/469 [..............................] - ETA: 13s - loss: 0.4194 - sparse_categorical_accuracy: 0.9219 49/469 [==>...........................] - ETA: 0s - loss: 0.3703 - sparse_categorical_accuracy: 0.9206 102/469 [=====>........................] - ETA: 0s - loss: 0.3972 - sparse_categorical_accuracy: 0.9158154/469 [========>.....................] - ETA: 0s - loss: 0.4179 - sparse_categorical_accuracy: 0.9108202/469 [===========>..................] - ETA: 0s - loss: 0.4218 - sparse_categorical_accuracy: 0.9105248/469 [==============>...............] - ETA: 0s - loss: 0.4309 - sparse_categorical_accuracy: 0.9096291/469 [=================>............] - ETA: 0s - loss: 0.4347 - sparse_categorical_accuracy: 0.9096332/469 [====================>.........] - ETA: 0s - loss: 0.4384 - sparse_categorical_accuracy: 0.9097375/469 [======================>.......] - ETA: 0s - loss: 0.4315 - sparse_categorical_accuracy: 0.9109417/469 [=========================>....] - ETA: 0s - loss: 0.4288 - sparse_categorical_accuracy: 0.9115456/469 [============================>.] - ETA: 0s - loss: 0.4259 - sparse_categorical_accuracy: 0.9122
Epoch 14: val_loss improved from 0.41339 to 0.36216, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.4244 - sparse_categorical_accuracy: 0.9124 - val_loss: 0.3622 - val_sparse_categorical_accuracy: 0.9244
Epoch 15/20
  1/469 [..............................] - ETA: 12s - loss: 0.5610 - sparse_categorical_accuracy: 0.9219 51/469 [==>...........................] - ETA: 0s - loss: 0.3823 - sparse_categorical_accuracy: 0.9206  98/469 [=====>........................] - ETA: 0s - loss: 0.3783 - sparse_categorical_accuracy: 0.9195140/469 [=======>......................] - ETA: 0s - loss: 0.3776 - sparse_categorical_accuracy: 0.9201183/469 [==========>...................] - ETA: 0s - loss: 0.3855 - sparse_categorical_accuracy: 0.9183229/469 [=============>................] - ETA: 0s - loss: 0.3848 - sparse_categorical_accuracy: 0.9186280/469 [================>.............] - ETA: 0s - loss: 0.3800 - sparse_categorical_accuracy: 0.9203325/469 [===================>..........] - ETA: 0s - loss: 0.3859 - sparse_categorical_accuracy: 0.9198375/469 [======================>.......] - ETA: 0s - loss: 0.3871 - sparse_categorical_accuracy: 0.9196416/469 [=========================>....] - ETA: 0s - loss: 0.3882 - sparse_categorical_accuracy: 0.9192457/469 [============================>.] - ETA: 0s - loss: 0.3932 - sparse_categorical_accuracy: 0.9184
Epoch 15: val_loss did not improve from 0.36216
469/469 [==============================] - 1s 1ms/step - loss: 0.3948 - sparse_categorical_accuracy: 0.9180 - val_loss: 0.3935 - val_sparse_categorical_accuracy: 0.9154
Epoch 16/20
  1/469 [..............................] - ETA: 13s - loss: 0.4542 - sparse_categorical_accuracy: 0.9219 50/469 [==>...........................] - ETA: 0s - loss: 0.3828 - sparse_categorical_accuracy: 0.9184  98/469 [=====>........................] - ETA: 0s - loss: 0.4073 - sparse_categorical_accuracy: 0.9155143/469 [========>.....................] - ETA: 0s - loss: 0.3967 - sparse_categorical_accuracy: 0.9155185/469 [==========>...................] - ETA: 0s - loss: 0.3917 - sparse_categorical_accuracy: 0.9151225/469 [=============>................] - ETA: 0s - loss: 0.3946 - sparse_categorical_accuracy: 0.9155259/469 [===============>..............] - ETA: 0s - loss: 0.3929 - sparse_categorical_accuracy: 0.9161295/469 [=================>............] - ETA: 0s - loss: 0.3963 - sparse_categorical_accuracy: 0.9147338/469 [====================>.........] - ETA: 0s - loss: 0.3967 - sparse_categorical_accuracy: 0.9147388/469 [=======================>......] - ETA: 0s - loss: 0.3913 - sparse_categorical_accuracy: 0.9161430/469 [==========================>...] - ETA: 0s - loss: 0.3886 - sparse_categorical_accuracy: 0.9165466/469 [============================>.] - ETA: 0s - loss: 0.3922 - sparse_categorical_accuracy: 0.9158
Epoch 16: val_loss did not improve from 0.36216
469/469 [==============================] - 1s 1ms/step - loss: 0.3923 - sparse_categorical_accuracy: 0.9158 - val_loss: 0.3647 - val_sparse_categorical_accuracy: 0.9275
Epoch 17/20
  1/469 [..............................] - ETA: 13s - loss: 0.1457 - sparse_categorical_accuracy: 0.9688 45/469 [=>............................] - ETA: 0s - loss: 0.3547 - sparse_categorical_accuracy: 0.9191  84/469 [====>.........................] - ETA: 0s - loss: 0.3581 - sparse_categorical_accuracy: 0.9197123/469 [======>.......................] - ETA: 0s - loss: 0.3682 - sparse_categorical_accuracy: 0.9206160/469 [=========>....................] - ETA: 0s - loss: 0.3737 - sparse_categorical_accuracy: 0.9195198/469 [===========>..................] - ETA: 0s - loss: 0.3694 - sparse_categorical_accuracy: 0.9205236/469 [==============>...............] - ETA: 0s - loss: 0.3764 - sparse_categorical_accuracy: 0.9193277/469 [================>.............] - ETA: 0s - loss: 0.3804 - sparse_categorical_accuracy: 0.9187313/469 [===================>..........] - ETA: 0s - loss: 0.3902 - sparse_categorical_accuracy: 0.9176349/469 [=====================>........] - ETA: 0s - loss: 0.3977 - sparse_categorical_accuracy: 0.9165385/469 [=======================>......] - ETA: 0s - loss: 0.4017 - sparse_categorical_accuracy: 0.9155424/469 [==========================>...] - ETA: 0s - loss: 0.4006 - sparse_categorical_accuracy: 0.9156
Epoch 17: val_loss did not improve from 0.36216
469/469 [==============================] - 1s 1ms/step - loss: 0.4018 - sparse_categorical_accuracy: 0.9157 - val_loss: 0.3874 - val_sparse_categorical_accuracy: 0.9251
Epoch 18/20
  1/469 [..............................] - ETA: 12s - loss: 0.1210 - sparse_categorical_accuracy: 0.9688 45/469 [=>............................] - ETA: 0s - loss: 0.3291 - sparse_categorical_accuracy: 0.9267  89/469 [====>.........................] - ETA: 0s - loss: 0.3641 - sparse_categorical_accuracy: 0.9211130/469 [=======>......................] - ETA: 0s - loss: 0.3666 - sparse_categorical_accuracy: 0.9213176/469 [==========>...................] - ETA: 0s - loss: 0.3674 - sparse_categorical_accuracy: 0.9205222/469 [=============>................] - ETA: 0s - loss: 0.3672 - sparse_categorical_accuracy: 0.9205267/469 [================>.............] - ETA: 0s - loss: 0.3755 - sparse_categorical_accuracy: 0.9196313/469 [===================>..........] - ETA: 0s - loss: 0.3758 - sparse_categorical_accuracy: 0.9195353/469 [=====================>........] - ETA: 0s - loss: 0.3758 - sparse_categorical_accuracy: 0.9192404/469 [========================>.....] - ETA: 0s - loss: 0.3749 - sparse_categorical_accuracy: 0.9196445/469 [===========================>..] - ETA: 0s - loss: 0.3723 - sparse_categorical_accuracy: 0.9196
Epoch 18: val_loss improved from 0.36216 to 0.36002, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.3711 - sparse_categorical_accuracy: 0.9195 - val_loss: 0.3600 - val_sparse_categorical_accuracy: 0.9166
Epoch 19/20
  1/469 [..............................] - ETA: 13s - loss: 0.3380 - sparse_categorical_accuracy: 0.9062 48/469 [==>...........................] - ETA: 0s - loss: 0.3750 - sparse_categorical_accuracy: 0.9196  99/469 [=====>........................] - ETA: 0s - loss: 0.3747 - sparse_categorical_accuracy: 0.9186148/469 [========>.....................] - ETA: 0s - loss: 0.3622 - sparse_categorical_accuracy: 0.9211192/469 [===========>..................] - ETA: 0s - loss: 0.3442 - sparse_categorical_accuracy: 0.9237232/469 [=============>................] - ETA: 0s - loss: 0.3491 - sparse_categorical_accuracy: 0.9225278/469 [================>.............] - ETA: 0s - loss: 0.3508 - sparse_categorical_accuracy: 0.9220329/469 [====================>.........] - ETA: 0s - loss: 0.3556 - sparse_categorical_accuracy: 0.9215376/469 [=======================>......] - ETA: 0s - loss: 0.3569 - sparse_categorical_accuracy: 0.9217419/469 [=========================>....] - ETA: 0s - loss: 0.3569 - sparse_categorical_accuracy: 0.9221460/469 [============================>.] - ETA: 0s - loss: 0.3631 - sparse_categorical_accuracy: 0.9218
Epoch 19: val_loss improved from 0.36002 to 0.35011, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.3631 - sparse_categorical_accuracy: 0.9217 - val_loss: 0.3501 - val_sparse_categorical_accuracy: 0.9284
Epoch 20/20
  1/469 [..............................] - ETA: 14s - loss: 0.2175 - sparse_categorical_accuracy: 0.9297 53/469 [==>...........................] - ETA: 0s - loss: 0.3272 - sparse_categorical_accuracy: 0.9269 103/469 [=====>........................] - ETA: 0s - loss: 0.3318 - sparse_categorical_accuracy: 0.9269151/469 [========>.....................] - ETA: 0s - loss: 0.3396 - sparse_categorical_accuracy: 0.9261200/469 [===========>..................] - ETA: 0s - loss: 0.3461 - sparse_categorical_accuracy: 0.9244252/469 [===============>..............] - ETA: 0s - loss: 0.3502 - sparse_categorical_accuracy: 0.9231303/469 [==================>...........] - ETA: 0s - loss: 0.3541 - sparse_categorical_accuracy: 0.9231348/469 [=====================>........] - ETA: 0s - loss: 0.3581 - sparse_categorical_accuracy: 0.9234393/469 [========================>.....] - ETA: 0s - loss: 0.3601 - sparse_categorical_accuracy: 0.9237435/469 [==========================>...] - ETA: 0s - loss: 0.3574 - sparse_categorical_accuracy: 0.9241
Epoch 20: val_loss did not improve from 0.35011
469/469 [==============================] - 1s 1ms/step - loss: 0.3565 - sparse_categorical_accuracy: 0.9243 - val_loss: 0.4167 - val_sparse_categorical_accuracy: 0.9117
Evaluting model with ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7fc46c31c290> has ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7fc46c39a750> has ber = 1.0
 1/79 [..............................] - ETA: 1s - loss: 0.2683 - sparse_categorical_accuracy: 0.906265/79 [=======================>......] - ETA: 0s - loss: 0.4176 - sparse_categorical_accuracy: 0.911279/79 [==============================] - 0s 802us/step - loss: 0.4167 - sparse_categorical_accuracy: 0.9117

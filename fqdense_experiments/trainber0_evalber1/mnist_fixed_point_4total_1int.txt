2022-08-23 10:58:38.732294: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:58:38.735515: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:58:38.735826: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:58:38.736301: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-08-23 10:58:38.737011: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:58:38.737317: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:58:38.737600: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:58:39.026555: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:58:39.026842: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:58:39.027095: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 10:58:39.027336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 6536 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1070, pci bus id: 0000:0a:00.0, compute capability: 6.1
Logit total bits = 4, int bits = 1
Activation total bits = 4, int bits = 1
<keras.engine.functional.Functional object at 0x7facc4165210>
#################
# MODEL SUMMARY #
#################
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 28, 28)]          0         
                                                                 
 flatten (Flatten)           (None, 784)               0         
                                                                 
 fq_dense (FQDense)          (None, 128)               100480    
                                                                 
 q_activation_1 (QActivation  (None, 128)              0         
 )                                                               
                                                                 
 fq_dense_1 (FQDense)        (None, 10)                1290      
                                                                 
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
None
#################
Training with ber = 0.0
Layer <fkeras.fdense.FQDense object at 0x7faccc09a810> has ber = 0.0
Layer <fkeras.fdense.FQDense object at 0x7facc43013d0> has ber = 0.0
Epoch 1/20
  1/469 [..............................] - ETA: 8:51 - loss: 6.7298 - sparse_categorical_accuracy: 0.0625 46/469 [=>............................] - ETA: 0s - loss: 3.4071 - sparse_categorical_accuracy: 0.2495   86/469 [====>.........................] - ETA: 0s - loss: 2.4382 - sparse_categorical_accuracy: 0.4095130/469 [=======>......................] - ETA: 0s - loss: 1.9565 - sparse_categorical_accuracy: 0.5051175/469 [==========>...................] - ETA: 0s - loss: 1.6655 - sparse_categorical_accuracy: 0.5683217/469 [============>.................] - ETA: 0s - loss: 1.4843 - sparse_categorical_accuracy: 0.6103262/469 [===============>..............] - ETA: 0s - loss: 1.3471 - sparse_categorical_accuracy: 0.6425308/469 [==================>...........] - ETA: 0s - loss: 1.2381 - sparse_categorical_accuracy: 0.6689355/469 [=====================>........] - ETA: 0s - loss: 1.1505 - sparse_categorical_accuracy: 0.6898402/469 [========================>.....] - ETA: 0s - loss: 1.0801 - sparse_categorical_accuracy: 0.7070450/469 [===========================>..] - ETA: 0s - loss: 1.0216 - sparse_categorical_accuracy: 0.7209
Epoch 1: val_loss improved from inf to 0.46299, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 2s 2ms/step - loss: 1.0006 - sparse_categorical_accuracy: 0.7264 - val_loss: 0.4630 - val_sparse_categorical_accuracy: 0.8650
Epoch 2/20
  1/469 [..............................] - ETA: 13s - loss: 0.5668 - sparse_categorical_accuracy: 0.8047 46/469 [=>............................] - ETA: 0s - loss: 0.4742 - sparse_categorical_accuracy: 0.8589  84/469 [====>.........................] - ETA: 0s - loss: 0.4632 - sparse_categorical_accuracy: 0.8593121/469 [======>.......................] - ETA: 0s - loss: 0.4696 - sparse_categorical_accuracy: 0.8601159/469 [=========>....................] - ETA: 0s - loss: 0.4590 - sparse_categorical_accuracy: 0.8631198/469 [===========>..................] - ETA: 0s - loss: 0.4559 - sparse_categorical_accuracy: 0.8632235/469 [==============>...............] - ETA: 0s - loss: 0.4507 - sparse_categorical_accuracy: 0.8653270/469 [================>.............] - ETA: 0s - loss: 0.4447 - sparse_categorical_accuracy: 0.8670307/469 [==================>...........] - ETA: 0s - loss: 0.4397 - sparse_categorical_accuracy: 0.8687346/469 [=====================>........] - ETA: 0s - loss: 0.4319 - sparse_categorical_accuracy: 0.8701384/469 [=======================>......] - ETA: 0s - loss: 0.4292 - sparse_categorical_accuracy: 0.8711424/469 [==========================>...] - ETA: 0s - loss: 0.4239 - sparse_categorical_accuracy: 0.8729463/469 [============================>.] - ETA: 0s - loss: 0.4208 - sparse_categorical_accuracy: 0.8743
Epoch 2: val_loss improved from 0.46299 to 0.35617, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 2ms/step - loss: 0.4198 - sparse_categorical_accuracy: 0.8746 - val_loss: 0.3562 - val_sparse_categorical_accuracy: 0.8994
Epoch 3/20
  1/469 [..............................] - ETA: 13s - loss: 0.4701 - sparse_categorical_accuracy: 0.8750 48/469 [==>...........................] - ETA: 0s - loss: 0.3445 - sparse_categorical_accuracy: 0.8939  96/469 [=====>........................] - ETA: 0s - loss: 0.3339 - sparse_categorical_accuracy: 0.8989143/469 [========>.....................] - ETA: 0s - loss: 0.3264 - sparse_categorical_accuracy: 0.9015190/469 [===========>..................] - ETA: 0s - loss: 0.3307 - sparse_categorical_accuracy: 0.9019237/469 [==============>...............] - ETA: 0s - loss: 0.3229 - sparse_categorical_accuracy: 0.9048279/469 [================>.............] - ETA: 0s - loss: 0.3213 - sparse_categorical_accuracy: 0.9047319/469 [===================>..........] - ETA: 0s - loss: 0.3215 - sparse_categorical_accuracy: 0.9042358/469 [=====================>........] - ETA: 0s - loss: 0.3193 - sparse_categorical_accuracy: 0.9050397/469 [========================>.....] - ETA: 0s - loss: 0.3190 - sparse_categorical_accuracy: 0.9046437/469 [==========================>...] - ETA: 0s - loss: 0.3209 - sparse_categorical_accuracy: 0.9041
Epoch 3: val_loss improved from 0.35617 to 0.31873, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.3170 - sparse_categorical_accuracy: 0.9054 - val_loss: 0.3187 - val_sparse_categorical_accuracy: 0.9079
Epoch 4/20
  1/469 [..............................] - ETA: 12s - loss: 0.2590 - sparse_categorical_accuracy: 0.9141 45/469 [=>............................] - ETA: 0s - loss: 0.2739 - sparse_categorical_accuracy: 0.9193  91/469 [====>.........................] - ETA: 0s - loss: 0.2707 - sparse_categorical_accuracy: 0.9190129/469 [=======>......................] - ETA: 0s - loss: 0.2761 - sparse_categorical_accuracy: 0.9173171/469 [=========>....................] - ETA: 0s - loss: 0.2751 - sparse_categorical_accuracy: 0.9176210/469 [============>.................] - ETA: 0s - loss: 0.2761 - sparse_categorical_accuracy: 0.9178254/469 [===============>..............] - ETA: 0s - loss: 0.2707 - sparse_categorical_accuracy: 0.9192300/469 [==================>...........] - ETA: 0s - loss: 0.2692 - sparse_categorical_accuracy: 0.9194344/469 [=====================>........] - ETA: 0s - loss: 0.2699 - sparse_categorical_accuracy: 0.9191386/469 [=======================>......] - ETA: 0s - loss: 0.2683 - sparse_categorical_accuracy: 0.9191429/469 [==========================>...] - ETA: 0s - loss: 0.2685 - sparse_categorical_accuracy: 0.9192469/469 [==============================] - ETA: 0s - loss: 0.2663 - sparse_categorical_accuracy: 0.9200
Epoch 4: val_loss improved from 0.31873 to 0.26190, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.2663 - sparse_categorical_accuracy: 0.9200 - val_loss: 0.2619 - val_sparse_categorical_accuracy: 0.9237
Epoch 5/20
  1/469 [..............................] - ETA: 13s - loss: 0.2218 - sparse_categorical_accuracy: 0.9375 50/469 [==>...........................] - ETA: 0s - loss: 0.2394 - sparse_categorical_accuracy: 0.9292  92/469 [====>.........................] - ETA: 0s - loss: 0.2402 - sparse_categorical_accuracy: 0.9276131/469 [=======>......................] - ETA: 0s - loss: 0.2360 - sparse_categorical_accuracy: 0.9281173/469 [==========>...................] - ETA: 0s - loss: 0.2366 - sparse_categorical_accuracy: 0.9278220/469 [=============>................] - ETA: 0s - loss: 0.2403 - sparse_categorical_accuracy: 0.9268262/469 [===============>..............] - ETA: 0s - loss: 0.2391 - sparse_categorical_accuracy: 0.9275305/469 [==================>...........] - ETA: 0s - loss: 0.2373 - sparse_categorical_accuracy: 0.9277348/469 [=====================>........] - ETA: 0s - loss: 0.2370 - sparse_categorical_accuracy: 0.9278392/469 [========================>.....] - ETA: 0s - loss: 0.2359 - sparse_categorical_accuracy: 0.9283436/469 [==========================>...] - ETA: 0s - loss: 0.2358 - sparse_categorical_accuracy: 0.9284
Epoch 5: val_loss improved from 0.26190 to 0.25328, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.2353 - sparse_categorical_accuracy: 0.9283 - val_loss: 0.2533 - val_sparse_categorical_accuracy: 0.9288
Epoch 6/20
  1/469 [..............................] - ETA: 12s - loss: 0.2609 - sparse_categorical_accuracy: 0.9141 50/469 [==>...........................] - ETA: 0s - loss: 0.2106 - sparse_categorical_accuracy: 0.9381 100/469 [=====>........................] - ETA: 0s - loss: 0.2075 - sparse_categorical_accuracy: 0.9376144/469 [========>.....................] - ETA: 0s - loss: 0.2075 - sparse_categorical_accuracy: 0.9379189/469 [===========>..................] - ETA: 0s - loss: 0.2091 - sparse_categorical_accuracy: 0.9372233/469 [=============>................] - ETA: 0s - loss: 0.2118 - sparse_categorical_accuracy: 0.9366274/469 [================>.............] - ETA: 0s - loss: 0.2124 - sparse_categorical_accuracy: 0.9371318/469 [===================>..........] - ETA: 0s - loss: 0.2136 - sparse_categorical_accuracy: 0.9366357/469 [=====================>........] - ETA: 0s - loss: 0.2124 - sparse_categorical_accuracy: 0.9366395/469 [========================>.....] - ETA: 0s - loss: 0.2113 - sparse_categorical_accuracy: 0.9369440/469 [===========================>..] - ETA: 0s - loss: 0.2103 - sparse_categorical_accuracy: 0.9373
Epoch 6: val_loss improved from 0.25328 to 0.22357, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.2097 - sparse_categorical_accuracy: 0.9376 - val_loss: 0.2236 - val_sparse_categorical_accuracy: 0.9340
Epoch 7/20
  1/469 [..............................] - ETA: 14s - loss: 0.2021 - sparse_categorical_accuracy: 0.9453 50/469 [==>...........................] - ETA: 0s - loss: 0.2007 - sparse_categorical_accuracy: 0.9398 100/469 [=====>........................] - ETA: 0s - loss: 0.2044 - sparse_categorical_accuracy: 0.9391147/469 [========>.....................] - ETA: 0s - loss: 0.2052 - sparse_categorical_accuracy: 0.9391191/469 [===========>..................] - ETA: 0s - loss: 0.2024 - sparse_categorical_accuracy: 0.9399236/469 [==============>...............] - ETA: 0s - loss: 0.2005 - sparse_categorical_accuracy: 0.9402280/469 [================>.............] - ETA: 0s - loss: 0.1971 - sparse_categorical_accuracy: 0.9408325/469 [===================>..........] - ETA: 0s - loss: 0.1982 - sparse_categorical_accuracy: 0.9405371/469 [======================>.......] - ETA: 0s - loss: 0.1979 - sparse_categorical_accuracy: 0.9406416/469 [=========================>....] - ETA: 0s - loss: 0.1979 - sparse_categorical_accuracy: 0.9408462/469 [============================>.] - ETA: 0s - loss: 0.1965 - sparse_categorical_accuracy: 0.9411
Epoch 7: val_loss did not improve from 0.22357
469/469 [==============================] - 1s 1ms/step - loss: 0.1964 - sparse_categorical_accuracy: 0.9411 - val_loss: 0.2392 - val_sparse_categorical_accuracy: 0.9307
Epoch 8/20
  1/469 [..............................] - ETA: 13s - loss: 0.3945 - sparse_categorical_accuracy: 0.8828 47/469 [==>...........................] - ETA: 0s - loss: 0.1792 - sparse_categorical_accuracy: 0.9460  94/469 [=====>........................] - ETA: 0s - loss: 0.1760 - sparse_categorical_accuracy: 0.9453140/469 [=======>......................] - ETA: 0s - loss: 0.1786 - sparse_categorical_accuracy: 0.9452188/469 [===========>..................] - ETA: 0s - loss: 0.1777 - sparse_categorical_accuracy: 0.9464233/469 [=============>................] - ETA: 0s - loss: 0.1772 - sparse_categorical_accuracy: 0.9469280/469 [================>.............] - ETA: 0s - loss: 0.1760 - sparse_categorical_accuracy: 0.9467328/469 [===================>..........] - ETA: 0s - loss: 0.1742 - sparse_categorical_accuracy: 0.9471374/469 [======================>.......] - ETA: 0s - loss: 0.1749 - sparse_categorical_accuracy: 0.9469420/469 [=========================>....] - ETA: 0s - loss: 0.1769 - sparse_categorical_accuracy: 0.9465463/469 [============================>.] - ETA: 0s - loss: 0.1758 - sparse_categorical_accuracy: 0.9467
Epoch 8: val_loss improved from 0.22357 to 0.21981, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1760 - sparse_categorical_accuracy: 0.9467 - val_loss: 0.2198 - val_sparse_categorical_accuracy: 0.9378
Epoch 9/20
  1/469 [..............................] - ETA: 13s - loss: 0.1165 - sparse_categorical_accuracy: 0.9531 51/469 [==>...........................] - ETA: 0s - loss: 0.1554 - sparse_categorical_accuracy: 0.9499  99/469 [=====>........................] - ETA: 0s - loss: 0.1486 - sparse_categorical_accuracy: 0.9519148/469 [========>.....................] - ETA: 0s - loss: 0.1596 - sparse_categorical_accuracy: 0.9496190/469 [===========>..................] - ETA: 0s - loss: 0.1620 - sparse_categorical_accuracy: 0.9488227/469 [=============>................] - ETA: 0s - loss: 0.1636 - sparse_categorical_accuracy: 0.9486265/469 [===============>..............] - ETA: 0s - loss: 0.1632 - sparse_categorical_accuracy: 0.9488303/469 [==================>...........] - ETA: 0s - loss: 0.1614 - sparse_categorical_accuracy: 0.9493341/469 [====================>.........] - ETA: 0s - loss: 0.1618 - sparse_categorical_accuracy: 0.9496381/469 [=======================>......] - ETA: 0s - loss: 0.1613 - sparse_categorical_accuracy: 0.9498430/469 [==========================>...] - ETA: 0s - loss: 0.1620 - sparse_categorical_accuracy: 0.9501
Epoch 9: val_loss improved from 0.21981 to 0.20263, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1631 - sparse_categorical_accuracy: 0.9499 - val_loss: 0.2026 - val_sparse_categorical_accuracy: 0.9450
Epoch 10/20
  1/469 [..............................] - ETA: 13s - loss: 0.1345 - sparse_categorical_accuracy: 0.9609 44/469 [=>............................] - ETA: 0s - loss: 0.1415 - sparse_categorical_accuracy: 0.9579  90/469 [====>.........................] - ETA: 0s - loss: 0.1350 - sparse_categorical_accuracy: 0.9600136/469 [=======>......................] - ETA: 0s - loss: 0.1366 - sparse_categorical_accuracy: 0.9596186/469 [==========>...................] - ETA: 0s - loss: 0.1397 - sparse_categorical_accuracy: 0.9585234/469 [=============>................] - ETA: 0s - loss: 0.1420 - sparse_categorical_accuracy: 0.9583285/469 [=================>............] - ETA: 0s - loss: 0.1455 - sparse_categorical_accuracy: 0.9571332/469 [====================>.........] - ETA: 0s - loss: 0.1454 - sparse_categorical_accuracy: 0.9567380/469 [=======================>......] - ETA: 0s - loss: 0.1449 - sparse_categorical_accuracy: 0.9563418/469 [=========================>....] - ETA: 0s - loss: 0.1455 - sparse_categorical_accuracy: 0.9560460/469 [============================>.] - ETA: 0s - loss: 0.1468 - sparse_categorical_accuracy: 0.9553
Epoch 10: val_loss improved from 0.20263 to 0.20123, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1470 - sparse_categorical_accuracy: 0.9552 - val_loss: 0.2012 - val_sparse_categorical_accuracy: 0.9430
Epoch 11/20
  1/469 [..............................] - ETA: 13s - loss: 0.1685 - sparse_categorical_accuracy: 0.9375 47/469 [==>...........................] - ETA: 0s - loss: 0.1300 - sparse_categorical_accuracy: 0.9618  94/469 [=====>........................] - ETA: 0s - loss: 0.1302 - sparse_categorical_accuracy: 0.9594141/469 [========>.....................] - ETA: 0s - loss: 0.1323 - sparse_categorical_accuracy: 0.9598191/469 [===========>..................] - ETA: 0s - loss: 0.1439 - sparse_categorical_accuracy: 0.9579241/469 [==============>...............] - ETA: 0s - loss: 0.1464 - sparse_categorical_accuracy: 0.9567289/469 [=================>............] - ETA: 0s - loss: 0.1482 - sparse_categorical_accuracy: 0.9560334/469 [====================>.........] - ETA: 0s - loss: 0.1484 - sparse_categorical_accuracy: 0.9557385/469 [=======================>......] - ETA: 0s - loss: 0.1516 - sparse_categorical_accuracy: 0.9548431/469 [==========================>...] - ETA: 0s - loss: 0.1510 - sparse_categorical_accuracy: 0.9550
Epoch 11: val_loss improved from 0.20123 to 0.18258, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1498 - sparse_categorical_accuracy: 0.9553 - val_loss: 0.1826 - val_sparse_categorical_accuracy: 0.9504
Epoch 12/20
  1/469 [..............................] - ETA: 13s - loss: 0.0643 - sparse_categorical_accuracy: 0.9766 46/469 [=>............................] - ETA: 0s - loss: 0.1113 - sparse_categorical_accuracy: 0.9659  87/469 [====>.........................] - ETA: 0s - loss: 0.1129 - sparse_categorical_accuracy: 0.9659128/469 [=======>......................] - ETA: 0s - loss: 0.1231 - sparse_categorical_accuracy: 0.9625164/469 [=========>....................] - ETA: 0s - loss: 0.1232 - sparse_categorical_accuracy: 0.9629211/469 [============>.................] - ETA: 0s - loss: 0.1247 - sparse_categorical_accuracy: 0.9623261/469 [===============>..............] - ETA: 0s - loss: 0.1268 - sparse_categorical_accuracy: 0.9611308/469 [==================>...........] - ETA: 0s - loss: 0.1276 - sparse_categorical_accuracy: 0.9608353/469 [=====================>........] - ETA: 0s - loss: 0.1296 - sparse_categorical_accuracy: 0.9601389/469 [=======================>......] - ETA: 0s - loss: 0.1304 - sparse_categorical_accuracy: 0.9597428/469 [==========================>...] - ETA: 0s - loss: 0.1319 - sparse_categorical_accuracy: 0.9595464/469 [============================>.] - ETA: 0s - loss: 0.1324 - sparse_categorical_accuracy: 0.9592
Epoch 12: val_loss improved from 0.18258 to 0.17131, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1319 - sparse_categorical_accuracy: 0.9593 - val_loss: 0.1713 - val_sparse_categorical_accuracy: 0.9534
Epoch 13/20
  1/469 [..............................] - ETA: 13s - loss: 0.1783 - sparse_categorical_accuracy: 0.9453 48/469 [==>...........................] - ETA: 0s - loss: 0.1107 - sparse_categorical_accuracy: 0.9644  92/469 [====>.........................] - ETA: 0s - loss: 0.1197 - sparse_categorical_accuracy: 0.9630132/469 [=======>......................] - ETA: 0s - loss: 0.1181 - sparse_categorical_accuracy: 0.9640172/469 [==========>...................] - ETA: 0s - loss: 0.1166 - sparse_categorical_accuracy: 0.9645212/469 [============>.................] - ETA: 0s - loss: 0.1237 - sparse_categorical_accuracy: 0.9623258/469 [===============>..............] - ETA: 0s - loss: 0.1266 - sparse_categorical_accuracy: 0.9619304/469 [==================>...........] - ETA: 0s - loss: 0.1271 - sparse_categorical_accuracy: 0.9616350/469 [=====================>........] - ETA: 0s - loss: 0.1280 - sparse_categorical_accuracy: 0.9613388/469 [=======================>......] - ETA: 0s - loss: 0.1305 - sparse_categorical_accuracy: 0.9605425/469 [==========================>...] - ETA: 0s - loss: 0.1337 - sparse_categorical_accuracy: 0.9599464/469 [============================>.] - ETA: 0s - loss: 0.1345 - sparse_categorical_accuracy: 0.9596
Epoch 13: val_loss did not improve from 0.17131
469/469 [==============================] - 1s 1ms/step - loss: 0.1343 - sparse_categorical_accuracy: 0.9597 - val_loss: 0.1799 - val_sparse_categorical_accuracy: 0.9508
Epoch 14/20
  1/469 [..............................] - ETA: 12s - loss: 0.1797 - sparse_categorical_accuracy: 0.9609 49/469 [==>...........................] - ETA: 0s - loss: 0.1068 - sparse_categorical_accuracy: 0.9688  94/469 [=====>........................] - ETA: 0s - loss: 0.1146 - sparse_categorical_accuracy: 0.9650140/469 [=======>......................] - ETA: 0s - loss: 0.1142 - sparse_categorical_accuracy: 0.9652179/469 [==========>...................] - ETA: 0s - loss: 0.1213 - sparse_categorical_accuracy: 0.9633219/469 [=============>................] - ETA: 0s - loss: 0.1225 - sparse_categorical_accuracy: 0.9632268/469 [================>.............] - ETA: 0s - loss: 0.1240 - sparse_categorical_accuracy: 0.9625307/469 [==================>...........] - ETA: 0s - loss: 0.1234 - sparse_categorical_accuracy: 0.9629346/469 [=====================>........] - ETA: 0s - loss: 0.1227 - sparse_categorical_accuracy: 0.9628387/469 [=======================>......] - ETA: 0s - loss: 0.1228 - sparse_categorical_accuracy: 0.9626426/469 [==========================>...] - ETA: 0s - loss: 0.1228 - sparse_categorical_accuracy: 0.9627466/469 [============================>.] - ETA: 0s - loss: 0.1231 - sparse_categorical_accuracy: 0.9629
Epoch 14: val_loss did not improve from 0.17131
469/469 [==============================] - 1s 1ms/step - loss: 0.1232 - sparse_categorical_accuracy: 0.9628 - val_loss: 0.1833 - val_sparse_categorical_accuracy: 0.9515
Epoch 15/20
  1/469 [..............................] - ETA: 13s - loss: 0.1447 - sparse_categorical_accuracy: 0.9609 45/469 [=>............................] - ETA: 0s - loss: 0.1028 - sparse_categorical_accuracy: 0.9694  86/469 [====>.........................] - ETA: 0s - loss: 0.1057 - sparse_categorical_accuracy: 0.9675124/469 [======>.......................] - ETA: 0s - loss: 0.1074 - sparse_categorical_accuracy: 0.9674167/469 [=========>....................] - ETA: 0s - loss: 0.1051 - sparse_categorical_accuracy: 0.9686208/469 [============>.................] - ETA: 0s - loss: 0.1059 - sparse_categorical_accuracy: 0.9681248/469 [==============>...............] - ETA: 0s - loss: 0.1085 - sparse_categorical_accuracy: 0.9670288/469 [=================>............] - ETA: 0s - loss: 0.1097 - sparse_categorical_accuracy: 0.9666327/469 [===================>..........] - ETA: 0s - loss: 0.1111 - sparse_categorical_accuracy: 0.9661366/469 [======================>.......] - ETA: 0s - loss: 0.1123 - sparse_categorical_accuracy: 0.9659405/469 [========================>.....] - ETA: 0s - loss: 0.1125 - sparse_categorical_accuracy: 0.9654440/469 [===========================>..] - ETA: 0s - loss: 0.1120 - sparse_categorical_accuracy: 0.9653
Epoch 15: val_loss did not improve from 0.17131
469/469 [==============================] - 1s 1ms/step - loss: 0.1125 - sparse_categorical_accuracy: 0.9654 - val_loss: 0.1861 - val_sparse_categorical_accuracy: 0.9512
Epoch 16/20
  1/469 [..............................] - ETA: 14s - loss: 0.0781 - sparse_categorical_accuracy: 0.9609 49/469 [==>...........................] - ETA: 0s - loss: 0.1207 - sparse_categorical_accuracy: 0.9638  98/469 [=====>........................] - ETA: 0s - loss: 0.1085 - sparse_categorical_accuracy: 0.9663137/469 [=======>......................] - ETA: 0s - loss: 0.1054 - sparse_categorical_accuracy: 0.9669184/469 [==========>...................] - ETA: 0s - loss: 0.1034 - sparse_categorical_accuracy: 0.9676222/469 [=============>................] - ETA: 0s - loss: 0.1052 - sparse_categorical_accuracy: 0.9668263/469 [===============>..............] - ETA: 0s - loss: 0.1052 - sparse_categorical_accuracy: 0.9668299/469 [==================>...........] - ETA: 0s - loss: 0.1089 - sparse_categorical_accuracy: 0.9661340/469 [====================>.........] - ETA: 0s - loss: 0.1089 - sparse_categorical_accuracy: 0.9661380/469 [=======================>......] - ETA: 0s - loss: 0.1100 - sparse_categorical_accuracy: 0.9658416/469 [=========================>....] - ETA: 0s - loss: 0.1092 - sparse_categorical_accuracy: 0.9658451/469 [===========================>..] - ETA: 0s - loss: 0.1091 - sparse_categorical_accuracy: 0.9660
Epoch 16: val_loss improved from 0.17131 to 0.16360, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1091 - sparse_categorical_accuracy: 0.9661 - val_loss: 0.1636 - val_sparse_categorical_accuracy: 0.9554
Epoch 17/20
  1/469 [..............................] - ETA: 13s - loss: 0.0753 - sparse_categorical_accuracy: 0.9766 47/469 [==>...........................] - ETA: 0s - loss: 0.0821 - sparse_categorical_accuracy: 0.9731  89/469 [====>.........................] - ETA: 0s - loss: 0.0866 - sparse_categorical_accuracy: 0.9717127/469 [=======>......................] - ETA: 0s - loss: 0.0912 - sparse_categorical_accuracy: 0.9716163/469 [=========>....................] - ETA: 0s - loss: 0.0898 - sparse_categorical_accuracy: 0.9718203/469 [===========>..................] - ETA: 0s - loss: 0.0923 - sparse_categorical_accuracy: 0.9714252/469 [===============>..............] - ETA: 0s - loss: 0.0954 - sparse_categorical_accuracy: 0.9707300/469 [==================>...........] - ETA: 0s - loss: 0.0976 - sparse_categorical_accuracy: 0.9702348/469 [=====================>........] - ETA: 0s - loss: 0.0998 - sparse_categorical_accuracy: 0.9696388/469 [=======================>......] - ETA: 0s - loss: 0.0991 - sparse_categorical_accuracy: 0.9695432/469 [==========================>...] - ETA: 0s - loss: 0.0980 - sparse_categorical_accuracy: 0.9696
Epoch 17: val_loss did not improve from 0.16360
469/469 [==============================] - 1s 1ms/step - loss: 0.0982 - sparse_categorical_accuracy: 0.9694 - val_loss: 0.1668 - val_sparse_categorical_accuracy: 0.9568
Epoch 18/20
  1/469 [..............................] - ETA: 12s - loss: 0.0357 - sparse_categorical_accuracy: 0.9844 47/469 [==>...........................] - ETA: 0s - loss: 0.0837 - sparse_categorical_accuracy: 0.9711  90/469 [====>.........................] - ETA: 0s - loss: 0.0909 - sparse_categorical_accuracy: 0.9690136/469 [=======>......................] - ETA: 0s - loss: 0.0916 - sparse_categorical_accuracy: 0.9701178/469 [==========>...................] - ETA: 0s - loss: 0.0882 - sparse_categorical_accuracy: 0.9706222/469 [=============>................] - ETA: 0s - loss: 0.0858 - sparse_categorical_accuracy: 0.9712272/469 [================>.............] - ETA: 0s - loss: 0.0891 - sparse_categorical_accuracy: 0.9708318/469 [===================>..........] - ETA: 0s - loss: 0.0899 - sparse_categorical_accuracy: 0.9706368/469 [======================>.......] - ETA: 0s - loss: 0.0927 - sparse_categorical_accuracy: 0.9702412/469 [=========================>....] - ETA: 0s - loss: 0.0929 - sparse_categorical_accuracy: 0.9703453/469 [===========================>..] - ETA: 0s - loss: 0.0939 - sparse_categorical_accuracy: 0.9702
Epoch 18: val_loss did not improve from 0.16360
469/469 [==============================] - 1s 1ms/step - loss: 0.0940 - sparse_categorical_accuracy: 0.9702 - val_loss: 0.2026 - val_sparse_categorical_accuracy: 0.9478
Epoch 19/20
  1/469 [..............................] - ETA: 13s - loss: 0.1242 - sparse_categorical_accuracy: 0.9609 50/469 [==>...........................] - ETA: 0s - loss: 0.0888 - sparse_categorical_accuracy: 0.9727  94/469 [=====>........................] - ETA: 0s - loss: 0.0888 - sparse_categorical_accuracy: 0.9721141/469 [========>.....................] - ETA: 0s - loss: 0.0860 - sparse_categorical_accuracy: 0.9729180/469 [==========>...................] - ETA: 0s - loss: 0.0889 - sparse_categorical_accuracy: 0.9719226/469 [=============>................] - ETA: 0s - loss: 0.0877 - sparse_categorical_accuracy: 0.9720273/469 [================>.............] - ETA: 0s - loss: 0.0877 - sparse_categorical_accuracy: 0.9725312/469 [==================>...........] - ETA: 0s - loss: 0.0883 - sparse_categorical_accuracy: 0.9723352/469 [=====================>........] - ETA: 0s - loss: 0.0882 - sparse_categorical_accuracy: 0.9721395/469 [========================>.....] - ETA: 0s - loss: 0.0919 - sparse_categorical_accuracy: 0.9713442/469 [===========================>..] - ETA: 0s - loss: 0.0923 - sparse_categorical_accuracy: 0.9712
Epoch 19: val_loss did not improve from 0.16360
469/469 [==============================] - 1s 1ms/step - loss: 0.0915 - sparse_categorical_accuracy: 0.9712 - val_loss: 0.1715 - val_sparse_categorical_accuracy: 0.9563
Epoch 20/20
  1/469 [..............................] - ETA: 13s - loss: 0.0895 - sparse_categorical_accuracy: 0.9688 50/469 [==>...........................] - ETA: 0s - loss: 0.0795 - sparse_categorical_accuracy: 0.9741 100/469 [=====>........................] - ETA: 0s - loss: 0.0786 - sparse_categorical_accuracy: 0.9747147/469 [========>.....................] - ETA: 0s - loss: 0.0784 - sparse_categorical_accuracy: 0.9755191/469 [===========>..................] - ETA: 0s - loss: 0.0817 - sparse_categorical_accuracy: 0.9746231/469 [=============>................] - ETA: 0s - loss: 0.0821 - sparse_categorical_accuracy: 0.9744272/469 [================>.............] - ETA: 0s - loss: 0.0834 - sparse_categorical_accuracy: 0.9741311/469 [==================>...........] - ETA: 0s - loss: 0.0834 - sparse_categorical_accuracy: 0.9739349/469 [=====================>........] - ETA: 0s - loss: 0.0852 - sparse_categorical_accuracy: 0.9736389/469 [=======================>......] - ETA: 0s - loss: 0.0885 - sparse_categorical_accuracy: 0.9724435/469 [==========================>...] - ETA: 0s - loss: 0.0893 - sparse_categorical_accuracy: 0.9723
Epoch 20: val_loss did not improve from 0.16360
469/469 [==============================] - 1s 1ms/step - loss: 0.0903 - sparse_categorical_accuracy: 0.9720 - val_loss: 0.1680 - val_sparse_categorical_accuracy: 0.9595
Evaluting model with ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7faccc09a810> has ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7facc43013d0> has ber = 1.0
 1/79 [..............................] - ETA: 1s - loss: 0.1457 - sparse_categorical_accuracy: 0.968865/79 [=======================>......] - ETA: 0s - loss: 0.1694 - sparse_categorical_accuracy: 0.959479/79 [==============================] - 0s 796us/step - loss: 0.1680 - sparse_categorical_accuracy: 0.9595

2022-08-23 11:08:39.201788: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:08:39.205039: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:08:39.205355: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:08:39.205833: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-08-23 11:08:39.206651: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:08:39.207017: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:08:39.207301: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:08:39.489847: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:08:39.490132: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:08:39.490386: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:08:39.490630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 6557 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1070, pci bus id: 0000:0a:00.0, compute capability: 6.1
Logit total bits = 2, int bits = 1
Activation total bits = 2, int bits = 1
<keras.engine.functional.Functional object at 0x7f75c8468f10>
#################
# MODEL SUMMARY #
#################
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 28, 28)]          0         
                                                                 
 flatten (Flatten)           (None, 784)               0         
                                                                 
 fq_dense (FQDense)          (None, 128)               100480    
                                                                 
 q_activation_1 (QActivation  (None, 128)              0         
 )                                                               
                                                                 
 fq_dense_1 (FQDense)        (None, 10)                1290      
                                                                 
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
None
#################
Training with ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f75d0056790> has ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f75d013e150> has ber = 1.0
Epoch 1/20
  1/469 [..............................] - ETA: 14:40 - loss: 31.3594 - sparse_categorical_accuracy: 0.0938 47/469 [==>...........................] - ETA: 0s - loss: 22.4084 - sparse_categorical_accuracy: 0.0991    94/469 [=====>........................] - ETA: 0s - loss: 15.9176 - sparse_categorical_accuracy: 0.1002140/469 [=======>......................] - ETA: 0s - loss: 12.4380 - sparse_categorical_accuracy: 0.1050184/469 [==========>...................] - ETA: 0s - loss: 10.2648 - sparse_categorical_accuracy: 0.1064231/469 [=============>................] - ETA: 0s - loss: 8.7684 - sparse_categorical_accuracy: 0.1051 278/469 [================>.............] - ETA: 0s - loss: 7.7514 - sparse_categorical_accuracy: 0.1036325/469 [===================>..........] - ETA: 0s - loss: 7.0447 - sparse_categorical_accuracy: 0.1042374/469 [======================>.......] - ETA: 0s - loss: 6.4939 - sparse_categorical_accuracy: 0.1033418/469 [=========================>....] - ETA: 0s - loss: 6.1465 - sparse_categorical_accuracy: 0.1037466/469 [============================>.] - ETA: 0s - loss: 5.8126 - sparse_categorical_accuracy: 0.1037
Epoch 1: val_loss improved from inf to 2.84782, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 3s 3ms/step - loss: 5.7957 - sparse_categorical_accuracy: 0.1039 - val_loss: 2.8478 - val_sparse_categorical_accuracy: 0.1135
Epoch 2/20
  1/469 [..............................] - ETA: 13s - loss: 2.6936 - sparse_categorical_accuracy: 0.0859 47/469 [==>...........................] - ETA: 0s - loss: 2.8523 - sparse_categorical_accuracy: 0.0979  89/469 [====>.........................] - ETA: 0s - loss: 2.8021 - sparse_categorical_accuracy: 0.1021139/469 [=======>......................] - ETA: 0s - loss: 2.7969 - sparse_categorical_accuracy: 0.1021179/469 [==========>...................] - ETA: 0s - loss: 2.8231 - sparse_categorical_accuracy: 0.1012218/469 [============>.................] - ETA: 0s - loss: 2.8508 - sparse_categorical_accuracy: 0.1014256/469 [===============>..............] - ETA: 0s - loss: 2.8451 - sparse_categorical_accuracy: 0.1014297/469 [=================>............] - ETA: 0s - loss: 2.8531 - sparse_categorical_accuracy: 0.1019332/469 [====================>.........] - ETA: 0s - loss: 2.8726 - sparse_categorical_accuracy: 0.1023371/469 [======================>.......] - ETA: 0s - loss: 2.8819 - sparse_categorical_accuracy: 0.1021408/469 [=========================>....] - ETA: 0s - loss: 2.8919 - sparse_categorical_accuracy: 0.1017443/469 [===========================>..] - ETA: 0s - loss: 2.8711 - sparse_categorical_accuracy: 0.1018
Epoch 2: val_loss did not improve from 2.84782
469/469 [==============================] - 1s 1ms/step - loss: 2.8641 - sparse_categorical_accuracy: 0.1020 - val_loss: 3.5362 - val_sparse_categorical_accuracy: 0.0980
Epoch 3/20
  1/469 [..............................] - ETA: 14s - loss: 3.5033 - sparse_categorical_accuracy: 0.0938 49/469 [==>...........................] - ETA: 0s - loss: 2.9150 - sparse_categorical_accuracy: 0.0976  95/469 [=====>........................] - ETA: 0s - loss: 2.9570 - sparse_categorical_accuracy: 0.1012142/469 [========>.....................] - ETA: 0s - loss: 2.9250 - sparse_categorical_accuracy: 0.1023186/469 [==========>...................] - ETA: 0s - loss: 2.9336 - sparse_categorical_accuracy: 0.1032234/469 [=============>................] - ETA: 0s - loss: 2.9254 - sparse_categorical_accuracy: 0.1039273/469 [================>.............] - ETA: 0s - loss: 2.9159 - sparse_categorical_accuracy: 0.1041320/469 [===================>..........] - ETA: 0s - loss: 2.8831 - sparse_categorical_accuracy: 0.1038369/469 [======================>.......] - ETA: 0s - loss: 2.8726 - sparse_categorical_accuracy: 0.1038410/469 [=========================>....] - ETA: 0s - loss: 2.8568 - sparse_categorical_accuracy: 0.1040454/469 [============================>.] - ETA: 0s - loss: 2.8594 - sparse_categorical_accuracy: 0.1039
Epoch 3: val_loss improved from 2.84782 to 2.49494, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 2.8622 - sparse_categorical_accuracy: 0.1035 - val_loss: 2.4949 - val_sparse_categorical_accuracy: 0.0980
Epoch 4/20
  1/469 [..............................] - ETA: 13s - loss: 2.5309 - sparse_categorical_accuracy: 0.1250 50/469 [==>...........................] - ETA: 0s - loss: 2.7881 - sparse_categorical_accuracy: 0.1048  95/469 [=====>........................] - ETA: 0s - loss: 2.8482 - sparse_categorical_accuracy: 0.1048140/469 [=======>......................] - ETA: 0s - loss: 2.9008 - sparse_categorical_accuracy: 0.1030188/469 [===========>..................] - ETA: 0s - loss: 2.9080 - sparse_categorical_accuracy: 0.1036236/469 [==============>...............] - ETA: 0s - loss: 2.9138 - sparse_categorical_accuracy: 0.1042280/469 [================>.............] - ETA: 0s - loss: 2.8981 - sparse_categorical_accuracy: 0.1041323/469 [===================>..........] - ETA: 0s - loss: 2.8912 - sparse_categorical_accuracy: 0.1035370/469 [======================>.......] - ETA: 0s - loss: 2.8901 - sparse_categorical_accuracy: 0.1035418/469 [=========================>....] - ETA: 0s - loss: 2.9027 - sparse_categorical_accuracy: 0.1036468/469 [============================>.] - ETA: 0s - loss: 2.9022 - sparse_categorical_accuracy: 0.1036
Epoch 4: val_loss did not improve from 2.49494
469/469 [==============================] - 1s 1ms/step - loss: 2.9015 - sparse_categorical_accuracy: 0.1036 - val_loss: 3.3346 - val_sparse_categorical_accuracy: 0.0982
Epoch 5/20
  1/469 [..............................] - ETA: 12s - loss: 3.2667 - sparse_categorical_accuracy: 0.1250 48/469 [==>...........................] - ETA: 0s - loss: 2.9093 - sparse_categorical_accuracy: 0.1082  86/469 [====>.........................] - ETA: 0s - loss: 2.9566 - sparse_categorical_accuracy: 0.1046121/469 [======>.......................] - ETA: 0s - loss: 2.9772 - sparse_categorical_accuracy: 0.1046158/469 [=========>....................] - ETA: 0s - loss: 2.9608 - sparse_categorical_accuracy: 0.1047189/469 [===========>..................] - ETA: 0s - loss: 2.9923 - sparse_categorical_accuracy: 0.1037229/469 [=============>................] - ETA: 0s - loss: 2.9927 - sparse_categorical_accuracy: 0.1046268/469 [================>.............] - ETA: 0s - loss: 2.9848 - sparse_categorical_accuracy: 0.1039308/469 [==================>...........] - ETA: 0s - loss: 2.9589 - sparse_categorical_accuracy: 0.1038346/469 [=====================>........] - ETA: 0s - loss: 2.9595 - sparse_categorical_accuracy: 0.1038383/469 [=======================>......] - ETA: 0s - loss: 2.9455 - sparse_categorical_accuracy: 0.1033423/469 [==========================>...] - ETA: 0s - loss: 2.9502 - sparse_categorical_accuracy: 0.1030461/469 [============================>.] - ETA: 0s - loss: 2.9482 - sparse_categorical_accuracy: 0.1033
Epoch 5: val_loss did not improve from 2.49494
469/469 [==============================] - 1s 1ms/step - loss: 2.9447 - sparse_categorical_accuracy: 0.1030 - val_loss: 3.7724 - val_sparse_categorical_accuracy: 0.1135
Epoch 6/20
  1/469 [..............................] - ETA: 13s - loss: 3.7876 - sparse_categorical_accuracy: 0.1016 50/469 [==>...........................] - ETA: 0s - loss: 2.8697 - sparse_categorical_accuracy: 0.0970 101/469 [=====>........................] - ETA: 0s - loss: 3.0094 - sparse_categorical_accuracy: 0.0984150/469 [========>.....................] - ETA: 0s - loss: 2.9910 - sparse_categorical_accuracy: 0.0985200/469 [===========>..................] - ETA: 0s - loss: 2.9790 - sparse_categorical_accuracy: 0.1006250/469 [==============>...............] - ETA: 0s - loss: 2.9916 - sparse_categorical_accuracy: 0.0996290/469 [=================>............] - ETA: 0s - loss: 2.9891 - sparse_categorical_accuracy: 0.1002338/469 [====================>.........] - ETA: 0s - loss: 2.9600 - sparse_categorical_accuracy: 0.1010382/469 [=======================>......] - ETA: 0s - loss: 2.9686 - sparse_categorical_accuracy: 0.1008430/469 [==========================>...] - ETA: 0s - loss: 2.9717 - sparse_categorical_accuracy: 0.1004
Epoch 6: val_loss did not improve from 2.49494
469/469 [==============================] - 1s 1ms/step - loss: 2.9802 - sparse_categorical_accuracy: 0.1009 - val_loss: 3.5680 - val_sparse_categorical_accuracy: 0.0980
Epoch 7/20
  1/469 [..............................] - ETA: 12s - loss: 3.5501 - sparse_categorical_accuracy: 0.0859 48/469 [==>...........................] - ETA: 0s - loss: 2.9688 - sparse_categorical_accuracy: 0.1029  85/469 [====>.........................] - ETA: 0s - loss: 2.9254 - sparse_categorical_accuracy: 0.1008118/469 [======>.......................] - ETA: 0s - loss: 3.0259 - sparse_categorical_accuracy: 0.0994156/469 [========>.....................] - ETA: 0s - loss: 3.1628 - sparse_categorical_accuracy: 0.1002195/469 [===========>..................] - ETA: 0s - loss: 3.2108 - sparse_categorical_accuracy: 0.1000232/469 [=============>................] - ETA: 0s - loss: 3.1936 - sparse_categorical_accuracy: 0.0997272/469 [================>.............] - ETA: 0s - loss: 3.2074 - sparse_categorical_accuracy: 0.0995312/469 [==================>...........] - ETA: 0s - loss: 3.1839 - sparse_categorical_accuracy: 0.0994353/469 [=====================>........] - ETA: 0s - loss: 3.1723 - sparse_categorical_accuracy: 0.1003393/469 [========================>.....] - ETA: 0s - loss: 3.1440 - sparse_categorical_accuracy: 0.1001434/469 [==========================>...] - ETA: 0s - loss: 3.1201 - sparse_categorical_accuracy: 0.0997
Epoch 7: val_loss did not improve from 2.49494
469/469 [==============================] - 1s 1ms/step - loss: 3.1196 - sparse_categorical_accuracy: 0.0998 - val_loss: 3.3208 - val_sparse_categorical_accuracy: 0.1028
Epoch 8/20
  1/469 [..............................] - ETA: 13s - loss: 3.3136 - sparse_categorical_accuracy: 0.0859 43/469 [=>............................] - ETA: 0s - loss: 2.9586 - sparse_categorical_accuracy: 0.0921  82/469 [====>.........................] - ETA: 0s - loss: 3.0434 - sparse_categorical_accuracy: 0.0974124/469 [======>.......................] - ETA: 0s - loss: 3.0053 - sparse_categorical_accuracy: 0.0968166/469 [=========>....................] - ETA: 0s - loss: 3.1080 - sparse_categorical_accuracy: 0.0988204/469 [============>.................] - ETA: 0s - loss: 3.1664 - sparse_categorical_accuracy: 0.1004241/469 [==============>...............] - ETA: 0s - loss: 3.1503 - sparse_categorical_accuracy: 0.1001278/469 [================>.............] - ETA: 0s - loss: 3.1520 - sparse_categorical_accuracy: 0.1000315/469 [===================>..........] - ETA: 0s - loss: 3.1620 - sparse_categorical_accuracy: 0.0999355/469 [=====================>........] - ETA: 0s - loss: 3.1597 - sparse_categorical_accuracy: 0.1003396/469 [========================>.....] - ETA: 0s - loss: 3.1664 - sparse_categorical_accuracy: 0.1000437/469 [==========================>...] - ETA: 0s - loss: 3.1571 - sparse_categorical_accuracy: 0.0995
Epoch 8: val_loss did not improve from 2.49494
469/469 [==============================] - 1s 1ms/step - loss: 3.1465 - sparse_categorical_accuracy: 0.0999 - val_loss: 2.4949 - val_sparse_categorical_accuracy: 0.0980
Epoch 9/20
  1/469 [..............................] - ETA: 13s - loss: 2.4606 - sparse_categorical_accuracy: 0.1016 50/469 [==>...........................] - ETA: 0s - loss: 3.0825 - sparse_categorical_accuracy: 0.0983  98/469 [=====>........................] - ETA: 0s - loss: 3.0718 - sparse_categorical_accuracy: 0.0997146/469 [========>.....................] - ETA: 0s - loss: 3.1168 - sparse_categorical_accuracy: 0.0994195/469 [===========>..................] - ETA: 0s - loss: 3.1649 - sparse_categorical_accuracy: 0.0999238/469 [==============>...............] - ETA: 0s - loss: 3.1380 - sparse_categorical_accuracy: 0.1004284/469 [=================>............] - ETA: 0s - loss: 3.1554 - sparse_categorical_accuracy: 0.1005330/469 [====================>.........] - ETA: 0s - loss: 3.1979 - sparse_categorical_accuracy: 0.1013372/469 [======================>.......] - ETA: 0s - loss: 3.2033 - sparse_categorical_accuracy: 0.1016412/469 [=========================>....] - ETA: 0s - loss: 3.1940 - sparse_categorical_accuracy: 0.1018451/469 [===========================>..] - ETA: 0s - loss: 3.1830 - sparse_categorical_accuracy: 0.1019
Epoch 9: val_loss improved from 2.49494 to 2.30258, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 3.1910 - sparse_categorical_accuracy: 0.1020 - val_loss: 2.3026 - val_sparse_categorical_accuracy: 0.0980
Epoch 10/20
  1/469 [..............................] - ETA: 13s - loss: 2.3026 - sparse_categorical_accuracy: 0.0859 51/469 [==>...........................] - ETA: 0s - loss: 3.3151 - sparse_categorical_accuracy: 0.0977  99/469 [=====>........................] - ETA: 0s - loss: 3.3265 - sparse_categorical_accuracy: 0.0994138/469 [=======>......................] - ETA: 0s - loss: 3.3183 - sparse_categorical_accuracy: 0.1009179/469 [==========>...................] - ETA: 0s - loss: 3.3195 - sparse_categorical_accuracy: 0.1007219/469 [=============>................] - ETA: 0s - loss: 3.3390 - sparse_categorical_accuracy: 0.1006258/469 [===============>..............] - ETA: 0s - loss: 3.3409 - sparse_categorical_accuracy: 0.1010294/469 [=================>............] - ETA: 0s - loss: 3.3542 - sparse_categorical_accuracy: 0.1006330/469 [====================>.........] - ETA: 0s - loss: 3.3401 - sparse_categorical_accuracy: 0.1011370/469 [======================>.......] - ETA: 0s - loss: 3.3402 - sparse_categorical_accuracy: 0.1011417/469 [=========================>....] - ETA: 0s - loss: 3.3426 - sparse_categorical_accuracy: 0.1011468/469 [============================>.] - ETA: 0s - loss: 3.3531 - sparse_categorical_accuracy: 0.1012
Epoch 10: val_loss did not improve from 2.30258
469/469 [==============================] - 1s 1ms/step - loss: 3.3530 - sparse_categorical_accuracy: 0.1012 - val_loss: 3.3451 - val_sparse_categorical_accuracy: 0.0892
Epoch 11/20
  1/469 [..............................] - ETA: 14s - loss: 3.2476 - sparse_categorical_accuracy: 0.1016 47/469 [==>...........................] - ETA: 0s - loss: 3.3214 - sparse_categorical_accuracy: 0.1011  94/469 [=====>........................] - ETA: 0s - loss: 3.3405 - sparse_categorical_accuracy: 0.0995139/469 [=======>......................] - ETA: 0s - loss: 3.3236 - sparse_categorical_accuracy: 0.1021184/469 [==========>...................] - ETA: 0s - loss: 3.3492 - sparse_categorical_accuracy: 0.0999228/469 [=============>................] - ETA: 0s - loss: 3.3488 - sparse_categorical_accuracy: 0.1009266/469 [================>.............] - ETA: 0s - loss: 3.3290 - sparse_categorical_accuracy: 0.1008307/469 [==================>...........] - ETA: 0s - loss: 3.3375 - sparse_categorical_accuracy: 0.1003349/469 [=====================>........] - ETA: 0s - loss: 3.3550 - sparse_categorical_accuracy: 0.1000391/469 [========================>.....] - ETA: 0s - loss: 3.3643 - sparse_categorical_accuracy: 0.1001436/469 [==========================>...] - ETA: 0s - loss: 3.3580 - sparse_categorical_accuracy: 0.0999
Epoch 11: val_loss did not improve from 2.30258
469/469 [==============================] - 1s 1ms/step - loss: 3.3500 - sparse_categorical_accuracy: 0.1002 - val_loss: 2.3026 - val_sparse_categorical_accuracy: 0.0980
Epoch 12/20
  1/469 [..............................] - ETA: 12s - loss: 2.3026 - sparse_categorical_accuracy: 0.0859 46/469 [=>............................] - ETA: 0s - loss: 3.4637 - sparse_categorical_accuracy: 0.0970  91/469 [====>.........................] - ETA: 0s - loss: 3.4536 - sparse_categorical_accuracy: 0.1007134/469 [=======>......................] - ETA: 0s - loss: 3.4367 - sparse_categorical_accuracy: 0.0995171/469 [=========>....................] - ETA: 0s - loss: 3.4323 - sparse_categorical_accuracy: 0.1000213/469 [============>.................] - ETA: 0s - loss: 3.4120 - sparse_categorical_accuracy: 0.1018255/469 [===============>..............] - ETA: 0s - loss: 3.3996 - sparse_categorical_accuracy: 0.1010294/469 [=================>............] - ETA: 0s - loss: 3.3950 - sparse_categorical_accuracy: 0.1013336/469 [====================>.........] - ETA: 0s - loss: 3.4032 - sparse_categorical_accuracy: 0.1017375/469 [======================>.......] - ETA: 0s - loss: 3.4064 - sparse_categorical_accuracy: 0.1016416/469 [=========================>....] - ETA: 0s - loss: 3.4004 - sparse_categorical_accuracy: 0.1011458/469 [============================>.] - ETA: 0s - loss: 3.3940 - sparse_categorical_accuracy: 0.1017
Epoch 12: val_loss did not improve from 2.30258
469/469 [==============================] - 1s 1ms/step - loss: 3.3955 - sparse_categorical_accuracy: 0.1016 - val_loss: 3.3121 - val_sparse_categorical_accuracy: 0.1032
Epoch 13/20
  1/469 [..............................] - ETA: 12s - loss: 3.5288 - sparse_categorical_accuracy: 0.0781 42/469 [=>............................] - ETA: 0s - loss: 3.3766 - sparse_categorical_accuracy: 0.1019  84/469 [====>.........................] - ETA: 0s - loss: 3.4075 - sparse_categorical_accuracy: 0.0966129/469 [=======>......................] - ETA: 0s - loss: 3.4214 - sparse_categorical_accuracy: 0.0998171/469 [=========>....................] - ETA: 0s - loss: 3.4330 - sparse_categorical_accuracy: 0.1003213/469 [============>.................] - ETA: 0s - loss: 3.4463 - sparse_categorical_accuracy: 0.1006254/469 [===============>..............] - ETA: 0s - loss: 3.4404 - sparse_categorical_accuracy: 0.1006293/469 [=================>............] - ETA: 0s - loss: 3.4454 - sparse_categorical_accuracy: 0.1004335/469 [====================>.........] - ETA: 0s - loss: 3.4493 - sparse_categorical_accuracy: 0.1010376/469 [=======================>......] - ETA: 0s - loss: 3.4458 - sparse_categorical_accuracy: 0.1015417/469 [=========================>....] - ETA: 0s - loss: 3.4516 - sparse_categorical_accuracy: 0.1011458/469 [============================>.] - ETA: 0s - loss: 3.4541 - sparse_categorical_accuracy: 0.1007
Epoch 13: val_loss did not improve from 2.30258
469/469 [==============================] - 1s 1ms/step - loss: 3.4561 - sparse_categorical_accuracy: 0.1005 - val_loss: 3.5479 - val_sparse_categorical_accuracy: 0.1010
Epoch 14/20
  1/469 [..............................] - ETA: 12s - loss: 3.6035 - sparse_categorical_accuracy: 0.1328 48/469 [==>...........................] - ETA: 0s - loss: 3.5016 - sparse_categorical_accuracy: 0.1037  95/469 [=====>........................] - ETA: 0s - loss: 3.4458 - sparse_categorical_accuracy: 0.1029140/469 [=======>......................] - ETA: 0s - loss: 3.4208 - sparse_categorical_accuracy: 0.1014181/469 [==========>...................] - ETA: 0s - loss: 3.4181 - sparse_categorical_accuracy: 0.1020224/469 [=============>................] - ETA: 0s - loss: 3.4064 - sparse_categorical_accuracy: 0.1025266/469 [================>.............] - ETA: 0s - loss: 3.4053 - sparse_categorical_accuracy: 0.1020304/469 [==================>...........] - ETA: 0s - loss: 3.4223 - sparse_categorical_accuracy: 0.1028343/469 [====================>.........] - ETA: 0s - loss: 3.4203 - sparse_categorical_accuracy: 0.1023386/469 [=======================>......] - ETA: 0s - loss: 3.4206 - sparse_categorical_accuracy: 0.1021422/469 [=========================>....] - ETA: 0s - loss: 3.4105 - sparse_categorical_accuracy: 0.1027464/469 [============================>.] - ETA: 0s - loss: 3.4063 - sparse_categorical_accuracy: 0.1027
Epoch 14: val_loss did not improve from 2.30258
469/469 [==============================] - 1s 1ms/step - loss: 3.4046 - sparse_categorical_accuracy: 0.1024 - val_loss: 3.1244 - val_sparse_categorical_accuracy: 0.1135
Epoch 15/20
  1/469 [..............................] - ETA: 12s - loss: 2.9237 - sparse_categorical_accuracy: 0.0859 47/469 [==>...........................] - ETA: 0s - loss: 3.4222 - sparse_categorical_accuracy: 0.1007  88/469 [====>.........................] - ETA: 0s - loss: 3.4506 - sparse_categorical_accuracy: 0.0985131/469 [=======>......................] - ETA: 0s - loss: 3.4224 - sparse_categorical_accuracy: 0.0980169/469 [=========>....................] - ETA: 0s - loss: 3.3976 - sparse_categorical_accuracy: 0.0981213/469 [============>.................] - ETA: 0s - loss: 3.4114 - sparse_categorical_accuracy: 0.1001259/469 [===============>..............] - ETA: 0s - loss: 3.3896 - sparse_categorical_accuracy: 0.1002303/469 [==================>...........] - ETA: 0s - loss: 3.3830 - sparse_categorical_accuracy: 0.1009348/469 [=====================>........] - ETA: 0s - loss: 3.3751 - sparse_categorical_accuracy: 0.1020396/469 [========================>.....] - ETA: 0s - loss: 3.3799 - sparse_categorical_accuracy: 0.1025443/469 [===========================>..] - ETA: 0s - loss: 3.3925 - sparse_categorical_accuracy: 0.1023
Epoch 15: val_loss did not improve from 2.30258
469/469 [==============================] - 1s 1ms/step - loss: 3.3921 - sparse_categorical_accuracy: 0.1020 - val_loss: 3.5851 - val_sparse_categorical_accuracy: 0.0980
Epoch 16/20
  1/469 [..............................] - ETA: 13s - loss: 3.7910 - sparse_categorical_accuracy: 0.0781 50/469 [==>...........................] - ETA: 0s - loss: 3.3533 - sparse_categorical_accuracy: 0.1064  97/469 [=====>........................] - ETA: 0s - loss: 3.3849 - sparse_categorical_accuracy: 0.1044143/469 [========>.....................] - ETA: 0s - loss: 3.4107 - sparse_categorical_accuracy: 0.1021185/469 [==========>...................] - ETA: 0s - loss: 3.4085 - sparse_categorical_accuracy: 0.1024227/469 [=============>................] - ETA: 0s - loss: 3.3982 - sparse_categorical_accuracy: 0.1032266/469 [================>.............] - ETA: 0s - loss: 3.4002 - sparse_categorical_accuracy: 0.1022301/469 [==================>...........] - ETA: 0s - loss: 3.4001 - sparse_categorical_accuracy: 0.1029337/469 [====================>.........] - ETA: 0s - loss: 3.3890 - sparse_categorical_accuracy: 0.1030373/469 [======================>.......] - ETA: 0s - loss: 3.3890 - sparse_categorical_accuracy: 0.1026413/469 [=========================>....] - ETA: 0s - loss: 3.3822 - sparse_categorical_accuracy: 0.1026450/469 [===========================>..] - ETA: 0s - loss: 3.3785 - sparse_categorical_accuracy: 0.1022
Epoch 16: val_loss did not improve from 2.30258
469/469 [==============================] - 1s 1ms/step - loss: 3.3747 - sparse_categorical_accuracy: 0.1020 - val_loss: 3.2937 - val_sparse_categorical_accuracy: 0.0980
Epoch 17/20
  1/469 [..............................] - ETA: 13s - loss: 3.2864 - sparse_categorical_accuracy: 0.0938 43/469 [=>............................] - ETA: 0s - loss: 3.3394 - sparse_categorical_accuracy: 0.1063  84/469 [====>.........................] - ETA: 0s - loss: 3.3887 - sparse_categorical_accuracy: 0.1037129/469 [=======>......................] - ETA: 0s - loss: 3.3754 - sparse_categorical_accuracy: 0.1036170/469 [=========>....................] - ETA: 0s - loss: 3.3583 - sparse_categorical_accuracy: 0.1048216/469 [============>.................] - ETA: 0s - loss: 3.3640 - sparse_categorical_accuracy: 0.1030259/469 [===============>..............] - ETA: 0s - loss: 3.3628 - sparse_categorical_accuracy: 0.1026303/469 [==================>...........] - ETA: 0s - loss: 3.3578 - sparse_categorical_accuracy: 0.1028345/469 [=====================>........] - ETA: 0s - loss: 3.3674 - sparse_categorical_accuracy: 0.1033388/469 [=======================>......] - ETA: 0s - loss: 3.3627 - sparse_categorical_accuracy: 0.1047429/469 [==========================>...] - ETA: 0s - loss: 3.3518 - sparse_categorical_accuracy: 0.1043
Epoch 17: val_loss did not improve from 2.30258
469/469 [==============================] - 1s 1ms/step - loss: 3.3481 - sparse_categorical_accuracy: 0.1040 - val_loss: 3.4349 - val_sparse_categorical_accuracy: 0.0980
Epoch 18/20
  1/469 [..............................] - ETA: 12s - loss: 3.2193 - sparse_categorical_accuracy: 0.1406 49/469 [==>...........................] - ETA: 0s - loss: 3.3577 - sparse_categorical_accuracy: 0.1012  90/469 [====>.........................] - ETA: 0s - loss: 3.3161 - sparse_categorical_accuracy: 0.1032138/469 [=======>......................] - ETA: 0s - loss: 3.3096 - sparse_categorical_accuracy: 0.1046188/469 [===========>..................] - ETA: 0s - loss: 3.2954 - sparse_categorical_accuracy: 0.1036232/469 [=============>................] - ETA: 0s - loss: 3.2992 - sparse_categorical_accuracy: 0.1033274/469 [================>.............] - ETA: 0s - loss: 3.3022 - sparse_categorical_accuracy: 0.1044313/469 [===================>..........] - ETA: 0s - loss: 3.3046 - sparse_categorical_accuracy: 0.1045354/469 [=====================>........] - ETA: 0s - loss: 3.2985 - sparse_categorical_accuracy: 0.1045396/469 [========================>.....] - ETA: 0s - loss: 3.3045 - sparse_categorical_accuracy: 0.1052434/469 [==========================>...] - ETA: 0s - loss: 3.3062 - sparse_categorical_accuracy: 0.1040
Epoch 18: val_loss did not improve from 2.30258
469/469 [==============================] - 1s 1ms/step - loss: 3.3004 - sparse_categorical_accuracy: 0.1037 - val_loss: 3.1604 - val_sparse_categorical_accuracy: 0.1135
Epoch 19/20
  1/469 [..............................] - ETA: 12s - loss: 3.1815 - sparse_categorical_accuracy: 0.1250 46/469 [=>............................] - ETA: 0s - loss: 3.3458 - sparse_categorical_accuracy: 0.1048  86/469 [====>.........................] - ETA: 0s - loss: 3.3353 - sparse_categorical_accuracy: 0.1048132/469 [=======>......................] - ETA: 0s - loss: 3.3374 - sparse_categorical_accuracy: 0.1070176/469 [==========>...................] - ETA: 0s - loss: 3.3218 - sparse_categorical_accuracy: 0.1071220/469 [=============>................] - ETA: 0s - loss: 3.3094 - sparse_categorical_accuracy: 0.1072261/469 [===============>..............] - ETA: 0s - loss: 3.3049 - sparse_categorical_accuracy: 0.1072300/469 [==================>...........] - ETA: 0s - loss: 3.3026 - sparse_categorical_accuracy: 0.1065335/469 [====================>.........] - ETA: 0s - loss: 3.3101 - sparse_categorical_accuracy: 0.1062370/469 [======================>.......] - ETA: 0s - loss: 3.3016 - sparse_categorical_accuracy: 0.1061406/469 [========================>.....] - ETA: 0s - loss: 3.3039 - sparse_categorical_accuracy: 0.1056438/469 [===========================>..] - ETA: 0s - loss: 3.3035 - sparse_categorical_accuracy: 0.1049
Epoch 19: val_loss did not improve from 2.30258
469/469 [==============================] - 1s 1ms/step - loss: 3.3064 - sparse_categorical_accuracy: 0.1045 - val_loss: 3.2757 - val_sparse_categorical_accuracy: 0.0982
Epoch 20/20
  1/469 [..............................] - ETA: 12s - loss: 3.1458 - sparse_categorical_accuracy: 0.0781 50/469 [==>...........................] - ETA: 0s - loss: 3.2892 - sparse_categorical_accuracy: 0.1013  98/469 [=====>........................] - ETA: 0s - loss: 3.3183 - sparse_categorical_accuracy: 0.1030143/469 [========>.....................] - ETA: 0s - loss: 3.3107 - sparse_categorical_accuracy: 0.1028186/469 [==========>...................] - ETA: 0s - loss: 3.2861 - sparse_categorical_accuracy: 0.1033229/469 [=============>................] - ETA: 0s - loss: 3.2711 - sparse_categorical_accuracy: 0.1037279/469 [================>.............] - ETA: 0s - loss: 3.2619 - sparse_categorical_accuracy: 0.1034326/469 [===================>..........] - ETA: 0s - loss: 3.2676 - sparse_categorical_accuracy: 0.1032369/469 [======================>.......] - ETA: 0s - loss: 3.2694 - sparse_categorical_accuracy: 0.1031405/469 [========================>.....] - ETA: 0s - loss: 3.2616 - sparse_categorical_accuracy: 0.1033449/469 [===========================>..] - ETA: 0s - loss: 3.2550 - sparse_categorical_accuracy: 0.1037
Epoch 20: val_loss did not improve from 2.30258
469/469 [==============================] - 1s 1ms/step - loss: 3.2544 - sparse_categorical_accuracy: 0.1032 - val_loss: 3.5500 - val_sparse_categorical_accuracy: 0.0980
Evaluting model with ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f75d0056790> has ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f75d013e150> has ber = 1.0
 1/79 [..............................] - ETA: 1s - loss: 3.6035 - sparse_categorical_accuracy: 0.117265/79 [=======================>......] - ETA: 0s - loss: 3.5512 - sparse_categorical_accuracy: 0.099279/79 [==============================] - 0s 785us/step - loss: 3.5500 - sparse_categorical_accuracy: 0.0980

2022-08-23 11:06:36.973887: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:06:36.977103: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:06:36.977426: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:06:36.977940: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-08-23 11:06:36.978627: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:06:36.979245: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:06:36.979532: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:06:37.255964: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:06:37.256264: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:06:37.256515: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:06:37.256759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 6556 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1070, pci bus id: 0000:0a:00.0, compute capability: 6.1
Logit total bits = 8, int bits = 3
Activation total bits = 8, int bits = 3
<keras.engine.functional.Functional object at 0x7f3bd4469a10>
#################
# MODEL SUMMARY #
#################
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 28, 28)]          0         
                                                                 
 flatten (Flatten)           (None, 784)               0         
                                                                 
 fq_dense (FQDense)          (None, 128)               100480    
                                                                 
 q_activation_1 (QActivation  (None, 128)              0         
 )                                                               
                                                                 
 fq_dense_1 (FQDense)        (None, 10)                1290      
                                                                 
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
None
#################
Training with ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f3bd46b2310> has ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f3bd4622610> has ber = 1.0
Epoch 1/20
  1/469 [..............................] - ETA: 34:25 - loss: 57.1844 - sparse_categorical_accuracy: 0.1250 43/469 [=>............................] - ETA: 0s - loss: 16.3234 - sparse_categorical_accuracy: 0.2860    85/469 [====>.........................] - ETA: 0s - loss: 8.8785 - sparse_categorical_accuracy: 0.4957 126/469 [=======>......................] - ETA: 0s - loss: 6.2260 - sparse_categorical_accuracy: 0.6009166/469 [=========>....................] - ETA: 0s - loss: 4.8768 - sparse_categorical_accuracy: 0.6586204/469 [============>.................] - ETA: 0s - loss: 4.0737 - sparse_categorical_accuracy: 0.6967242/469 [==============>...............] - ETA: 0s - loss: 3.5093 - sparse_categorical_accuracy: 0.7242280/469 [================>.............] - ETA: 0s - loss: 3.0979 - sparse_categorical_accuracy: 0.7443321/469 [===================>..........] - ETA: 0s - loss: 2.7592 - sparse_categorical_accuracy: 0.7621359/469 [=====================>........] - ETA: 0s - loss: 2.5095 - sparse_categorical_accuracy: 0.7759400/469 [========================>.....] - ETA: 0s - loss: 2.2995 - sparse_categorical_accuracy: 0.7872440/469 [===========================>..] - ETA: 0s - loss: 2.1263 - sparse_categorical_accuracy: 0.7969
Epoch 1: val_loss improved from inf to 0.40524, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 7s 5ms/step - loss: 2.0283 - sparse_categorical_accuracy: 0.8017 - val_loss: 0.4052 - val_sparse_categorical_accuracy: 0.9028
Epoch 2/20
  1/469 [..............................] - ETA: 14s - loss: 0.2443 - sparse_categorical_accuracy: 0.9219 46/469 [=>............................] - ETA: 0s - loss: 0.3612 - sparse_categorical_accuracy: 0.9068  91/469 [====>.........................] - ETA: 0s - loss: 0.3690 - sparse_categorical_accuracy: 0.9044138/469 [=======>......................] - ETA: 0s - loss: 0.3570 - sparse_categorical_accuracy: 0.9060187/469 [==========>...................] - ETA: 0s - loss: 0.3597 - sparse_categorical_accuracy: 0.9067236/469 [==============>...............] - ETA: 0s - loss: 0.3526 - sparse_categorical_accuracy: 0.9085283/469 [=================>............] - ETA: 0s - loss: 0.3518 - sparse_categorical_accuracy: 0.9087327/469 [===================>..........] - ETA: 0s - loss: 0.3447 - sparse_categorical_accuracy: 0.9101375/469 [======================>.......] - ETA: 0s - loss: 0.3455 - sparse_categorical_accuracy: 0.9102423/469 [==========================>...] - ETA: 0s - loss: 0.3411 - sparse_categorical_accuracy: 0.9115
Epoch 2: val_loss improved from 0.40524 to 0.30733, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.3384 - sparse_categorical_accuracy: 0.9128 - val_loss: 0.3073 - val_sparse_categorical_accuracy: 0.9232
Epoch 3/20
  1/469 [..............................] - ETA: 13s - loss: 0.2059 - sparse_categorical_accuracy: 0.9375 50/469 [==>...........................] - ETA: 0s - loss: 0.2854 - sparse_categorical_accuracy: 0.9252 101/469 [=====>........................] - ETA: 0s - loss: 0.2797 - sparse_categorical_accuracy: 0.9250152/469 [========>.....................] - ETA: 0s - loss: 0.2954 - sparse_categorical_accuracy: 0.9225201/469 [===========>..................] - ETA: 0s - loss: 0.2965 - sparse_categorical_accuracy: 0.9235249/469 [==============>...............] - ETA: 0s - loss: 0.2964 - sparse_categorical_accuracy: 0.9244297/469 [=================>............] - ETA: 0s - loss: 0.2883 - sparse_categorical_accuracy: 0.9261347/469 [=====================>........] - ETA: 0s - loss: 0.2805 - sparse_categorical_accuracy: 0.9277397/469 [========================>.....] - ETA: 0s - loss: 0.2770 - sparse_categorical_accuracy: 0.9288446/469 [===========================>..] - ETA: 0s - loss: 0.2743 - sparse_categorical_accuracy: 0.9292
Epoch 3: val_loss improved from 0.30733 to 0.22291, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.2714 - sparse_categorical_accuracy: 0.9296 - val_loss: 0.2229 - val_sparse_categorical_accuracy: 0.9453
Epoch 4/20
  1/469 [..............................] - ETA: 13s - loss: 0.1744 - sparse_categorical_accuracy: 0.9531 49/469 [==>...........................] - ETA: 0s - loss: 0.1965 - sparse_categorical_accuracy: 0.9420  97/469 [=====>........................] - ETA: 0s - loss: 0.2012 - sparse_categorical_accuracy: 0.9426145/469 [========>.....................] - ETA: 0s - loss: 0.2035 - sparse_categorical_accuracy: 0.9422193/469 [===========>..................] - ETA: 0s - loss: 0.2067 - sparse_categorical_accuracy: 0.9424241/469 [==============>...............] - ETA: 0s - loss: 0.2163 - sparse_categorical_accuracy: 0.9407289/469 [=================>............] - ETA: 0s - loss: 0.2273 - sparse_categorical_accuracy: 0.9391337/469 [====================>.........] - ETA: 0s - loss: 0.2323 - sparse_categorical_accuracy: 0.9385385/469 [=======================>......] - ETA: 0s - loss: 0.2381 - sparse_categorical_accuracy: 0.9376431/469 [==========================>...] - ETA: 0s - loss: 0.2387 - sparse_categorical_accuracy: 0.9378468/469 [============================>.] - ETA: 0s - loss: 0.2406 - sparse_categorical_accuracy: 0.9375
Epoch 4: val_loss did not improve from 0.22291
469/469 [==============================] - 1s 1ms/step - loss: 0.2412 - sparse_categorical_accuracy: 0.9374 - val_loss: 0.3103 - val_sparse_categorical_accuracy: 0.9269
Epoch 5/20
  1/469 [..............................] - ETA: 13s - loss: 0.2955 - sparse_categorical_accuracy: 0.9297 49/469 [==>...........................] - ETA: 0s - loss: 0.2077 - sparse_categorical_accuracy: 0.9431  98/469 [=====>........................] - ETA: 0s - loss: 0.2288 - sparse_categorical_accuracy: 0.9404140/469 [=======>......................] - ETA: 0s - loss: 0.2230 - sparse_categorical_accuracy: 0.9411184/469 [==========>...................] - ETA: 0s - loss: 0.2194 - sparse_categorical_accuracy: 0.9417228/469 [=============>................] - ETA: 0s - loss: 0.2148 - sparse_categorical_accuracy: 0.9421268/469 [================>.............] - ETA: 0s - loss: 0.2089 - sparse_categorical_accuracy: 0.9441310/469 [==================>...........] - ETA: 0s - loss: 0.2115 - sparse_categorical_accuracy: 0.9434349/469 [=====================>........] - ETA: 0s - loss: 0.2154 - sparse_categorical_accuracy: 0.9429393/469 [========================>.....] - ETA: 0s - loss: 0.2182 - sparse_categorical_accuracy: 0.9420438/469 [===========================>..] - ETA: 0s - loss: 0.2216 - sparse_categorical_accuracy: 0.9413
Epoch 5: val_loss did not improve from 0.22291
469/469 [==============================] - 1s 1ms/step - loss: 0.2223 - sparse_categorical_accuracy: 0.9412 - val_loss: 0.2826 - val_sparse_categorical_accuracy: 0.9339
Epoch 6/20
  1/469 [..............................] - ETA: 12s - loss: 0.2018 - sparse_categorical_accuracy: 0.9453 43/469 [=>............................] - ETA: 0s - loss: 0.2248 - sparse_categorical_accuracy: 0.9415  88/469 [====>.........................] - ETA: 0s - loss: 0.2184 - sparse_categorical_accuracy: 0.9455133/469 [=======>......................] - ETA: 0s - loss: 0.2138 - sparse_categorical_accuracy: 0.9453176/469 [==========>...................] - ETA: 0s - loss: 0.2232 - sparse_categorical_accuracy: 0.9434219/469 [=============>................] - ETA: 0s - loss: 0.2300 - sparse_categorical_accuracy: 0.9421263/469 [===============>..............] - ETA: 0s - loss: 0.2260 - sparse_categorical_accuracy: 0.9434301/469 [==================>...........] - ETA: 0s - loss: 0.2237 - sparse_categorical_accuracy: 0.9438344/469 [=====================>........] - ETA: 0s - loss: 0.2199 - sparse_categorical_accuracy: 0.9446386/469 [=======================>......] - ETA: 0s - loss: 0.2225 - sparse_categorical_accuracy: 0.9440427/469 [==========================>...] - ETA: 0s - loss: 0.2243 - sparse_categorical_accuracy: 0.9439468/469 [============================>.] - ETA: 0s - loss: 0.2237 - sparse_categorical_accuracy: 0.9440
Epoch 6: val_loss did not improve from 0.22291
469/469 [==============================] - 1s 1ms/step - loss: 0.2234 - sparse_categorical_accuracy: 0.9441 - val_loss: 0.2715 - val_sparse_categorical_accuracy: 0.9432
Epoch 7/20
  1/469 [..............................] - ETA: 13s - loss: 0.3608 - sparse_categorical_accuracy: 0.9531 45/469 [=>............................] - ETA: 0s - loss: 0.1782 - sparse_categorical_accuracy: 0.9538  87/469 [====>.........................] - ETA: 0s - loss: 0.1806 - sparse_categorical_accuracy: 0.9509128/469 [=======>......................] - ETA: 0s - loss: 0.1807 - sparse_categorical_accuracy: 0.9514168/469 [=========>....................] - ETA: 0s - loss: 0.1879 - sparse_categorical_accuracy: 0.9504211/469 [============>.................] - ETA: 0s - loss: 0.1933 - sparse_categorical_accuracy: 0.9498255/469 [===============>..............] - ETA: 0s - loss: 0.1917 - sparse_categorical_accuracy: 0.9496297/469 [=================>............] - ETA: 0s - loss: 0.1917 - sparse_categorical_accuracy: 0.9494340/469 [====================>.........] - ETA: 0s - loss: 0.1951 - sparse_categorical_accuracy: 0.9488383/469 [=======================>......] - ETA: 0s - loss: 0.1938 - sparse_categorical_accuracy: 0.9494427/469 [==========================>...] - ETA: 0s - loss: 0.1906 - sparse_categorical_accuracy: 0.9499468/469 [============================>.] - ETA: 0s - loss: 0.1922 - sparse_categorical_accuracy: 0.9498
Epoch 7: val_loss improved from 0.22291 to 0.20374, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1920 - sparse_categorical_accuracy: 0.9498 - val_loss: 0.2037 - val_sparse_categorical_accuracy: 0.9521
Epoch 8/20
  1/469 [..............................] - ETA: 13s - loss: 0.0708 - sparse_categorical_accuracy: 0.9688 48/469 [==>...........................] - ETA: 0s - loss: 0.1830 - sparse_categorical_accuracy: 0.9512  95/469 [=====>........................] - ETA: 0s - loss: 0.1651 - sparse_categorical_accuracy: 0.9556131/469 [=======>......................] - ETA: 0s - loss: 0.1631 - sparse_categorical_accuracy: 0.9556170/469 [=========>....................] - ETA: 0s - loss: 0.1676 - sparse_categorical_accuracy: 0.9553209/469 [============>.................] - ETA: 0s - loss: 0.1675 - sparse_categorical_accuracy: 0.9558248/469 [==============>...............] - ETA: 0s - loss: 0.1698 - sparse_categorical_accuracy: 0.9549293/469 [=================>............] - ETA: 0s - loss: 0.1716 - sparse_categorical_accuracy: 0.9549336/469 [====================>.........] - ETA: 0s - loss: 0.1742 - sparse_categorical_accuracy: 0.9541374/469 [======================>.......] - ETA: 0s - loss: 0.1802 - sparse_categorical_accuracy: 0.9525412/469 [=========================>....] - ETA: 0s - loss: 0.1834 - sparse_categorical_accuracy: 0.9522450/469 [===========================>..] - ETA: 0s - loss: 0.1875 - sparse_categorical_accuracy: 0.9514
Epoch 8: val_loss did not improve from 0.20374
469/469 [==============================] - 1s 1ms/step - loss: 0.1875 - sparse_categorical_accuracy: 0.9513 - val_loss: 0.2411 - val_sparse_categorical_accuracy: 0.9470
Epoch 9/20
  1/469 [..............................] - ETA: 12s - loss: 0.2914 - sparse_categorical_accuracy: 0.9531 41/469 [=>............................] - ETA: 0s - loss: 0.1795 - sparse_categorical_accuracy: 0.9518  85/469 [====>.........................] - ETA: 0s - loss: 0.1653 - sparse_categorical_accuracy: 0.9560124/469 [======>.......................] - ETA: 0s - loss: 0.1734 - sparse_categorical_accuracy: 0.9548165/469 [=========>....................] - ETA: 0s - loss: 0.1782 - sparse_categorical_accuracy: 0.9542205/469 [============>.................] - ETA: 0s - loss: 0.1845 - sparse_categorical_accuracy: 0.9526247/469 [==============>...............] - ETA: 0s - loss: 0.1832 - sparse_categorical_accuracy: 0.9528286/469 [=================>............] - ETA: 0s - loss: 0.1850 - sparse_categorical_accuracy: 0.9530328/469 [===================>..........] - ETA: 0s - loss: 0.1862 - sparse_categorical_accuracy: 0.9529369/469 [======================>.......] - ETA: 0s - loss: 0.1838 - sparse_categorical_accuracy: 0.9531407/469 [=========================>....] - ETA: 0s - loss: 0.1837 - sparse_categorical_accuracy: 0.9529445/469 [===========================>..] - ETA: 0s - loss: 0.1820 - sparse_categorical_accuracy: 0.9537
Epoch 9: val_loss did not improve from 0.20374
469/469 [==============================] - 1s 1ms/step - loss: 0.1822 - sparse_categorical_accuracy: 0.9539 - val_loss: 0.2643 - val_sparse_categorical_accuracy: 0.9429
Epoch 10/20
  1/469 [..............................] - ETA: 13s - loss: 0.2708 - sparse_categorical_accuracy: 0.9141 49/469 [==>...........................] - ETA: 0s - loss: 0.1466 - sparse_categorical_accuracy: 0.9606  90/469 [====>.........................] - ETA: 0s - loss: 0.1543 - sparse_categorical_accuracy: 0.9593135/469 [=======>......................] - ETA: 0s - loss: 0.1447 - sparse_categorical_accuracy: 0.9608177/469 [==========>...................] - ETA: 0s - loss: 0.1485 - sparse_categorical_accuracy: 0.9603224/469 [=============>................] - ETA: 0s - loss: 0.1514 - sparse_categorical_accuracy: 0.9602272/469 [================>.............] - ETA: 0s - loss: 0.1545 - sparse_categorical_accuracy: 0.9603320/469 [===================>..........] - ETA: 0s - loss: 0.1580 - sparse_categorical_accuracy: 0.9597360/469 [======================>.......] - ETA: 0s - loss: 0.1595 - sparse_categorical_accuracy: 0.9594400/469 [========================>.....] - ETA: 0s - loss: 0.1634 - sparse_categorical_accuracy: 0.9587442/469 [===========================>..] - ETA: 0s - loss: 0.1671 - sparse_categorical_accuracy: 0.9579
Epoch 10: val_loss did not improve from 0.20374
469/469 [==============================] - 1s 1ms/step - loss: 0.1699 - sparse_categorical_accuracy: 0.9575 - val_loss: 0.3199 - val_sparse_categorical_accuracy: 0.9352
Epoch 11/20
  1/469 [..............................] - ETA: 13s - loss: 0.2058 - sparse_categorical_accuracy: 0.9219 46/469 [=>............................] - ETA: 0s - loss: 0.1389 - sparse_categorical_accuracy: 0.9625  87/469 [====>.........................] - ETA: 0s - loss: 0.1441 - sparse_categorical_accuracy: 0.9613131/469 [=======>......................] - ETA: 0s - loss: 0.1476 - sparse_categorical_accuracy: 0.9609174/469 [==========>...................] - ETA: 0s - loss: 0.1469 - sparse_categorical_accuracy: 0.9620216/469 [============>.................] - ETA: 0s - loss: 0.1496 - sparse_categorical_accuracy: 0.9613259/469 [===============>..............] - ETA: 0s - loss: 0.1548 - sparse_categorical_accuracy: 0.9605305/469 [==================>...........] - ETA: 0s - loss: 0.1619 - sparse_categorical_accuracy: 0.9588348/469 [=====================>........] - ETA: 0s - loss: 0.1628 - sparse_categorical_accuracy: 0.9588393/469 [========================>.....] - ETA: 0s - loss: 0.1636 - sparse_categorical_accuracy: 0.9584436/469 [==========================>...] - ETA: 0s - loss: 0.1658 - sparse_categorical_accuracy: 0.9580
Epoch 11: val_loss did not improve from 0.20374
469/469 [==============================] - 1s 1ms/step - loss: 0.1673 - sparse_categorical_accuracy: 0.9579 - val_loss: 0.2422 - val_sparse_categorical_accuracy: 0.9518
Epoch 12/20
  1/469 [..............................] - ETA: 12s - loss: 0.2231 - sparse_categorical_accuracy: 0.9453 42/469 [=>............................] - ETA: 0s - loss: 0.1560 - sparse_categorical_accuracy: 0.9591  83/469 [====>.........................] - ETA: 0s - loss: 0.1599 - sparse_categorical_accuracy: 0.9608125/469 [======>.......................] - ETA: 0s - loss: 0.1619 - sparse_categorical_accuracy: 0.9604171/469 [=========>....................] - ETA: 0s - loss: 0.1665 - sparse_categorical_accuracy: 0.9592217/469 [============>.................] - ETA: 0s - loss: 0.1653 - sparse_categorical_accuracy: 0.9597262/469 [===============>..............] - ETA: 0s - loss: 0.1609 - sparse_categorical_accuracy: 0.9602306/469 [==================>...........] - ETA: 0s - loss: 0.1606 - sparse_categorical_accuracy: 0.9601349/469 [=====================>........] - ETA: 0s - loss: 0.1618 - sparse_categorical_accuracy: 0.9596393/469 [========================>.....] - ETA: 0s - loss: 0.1622 - sparse_categorical_accuracy: 0.9595435/469 [==========================>...] - ETA: 0s - loss: 0.1622 - sparse_categorical_accuracy: 0.9598
Epoch 12: val_loss did not improve from 0.20374
469/469 [==============================] - 1s 1ms/step - loss: 0.1608 - sparse_categorical_accuracy: 0.9599 - val_loss: 0.2298 - val_sparse_categorical_accuracy: 0.9524
Epoch 13/20
  1/469 [..............................] - ETA: 13s - loss: 0.0288 - sparse_categorical_accuracy: 0.9844 45/469 [=>............................] - ETA: 0s - loss: 0.1071 - sparse_categorical_accuracy: 0.9688  93/469 [====>.........................] - ETA: 0s - loss: 0.1207 - sparse_categorical_accuracy: 0.9668137/469 [=======>......................] - ETA: 0s - loss: 0.1304 - sparse_categorical_accuracy: 0.9658181/469 [==========>...................] - ETA: 0s - loss: 0.1322 - sparse_categorical_accuracy: 0.9656228/469 [=============>................] - ETA: 0s - loss: 0.1340 - sparse_categorical_accuracy: 0.9652272/469 [================>.............] - ETA: 0s - loss: 0.1383 - sparse_categorical_accuracy: 0.9645316/469 [===================>..........] - ETA: 0s - loss: 0.1429 - sparse_categorical_accuracy: 0.9639361/469 [======================>.......] - ETA: 0s - loss: 0.1493 - sparse_categorical_accuracy: 0.9627408/469 [=========================>....] - ETA: 0s - loss: 0.1543 - sparse_categorical_accuracy: 0.9618454/469 [============================>.] - ETA: 0s - loss: 0.1570 - sparse_categorical_accuracy: 0.9616
Epoch 13: val_loss did not improve from 0.20374
469/469 [==============================] - 1s 1ms/step - loss: 0.1579 - sparse_categorical_accuracy: 0.9614 - val_loss: 0.2856 - val_sparse_categorical_accuracy: 0.9453
Epoch 14/20
  1/469 [..............................] - ETA: 13s - loss: 0.3180 - sparse_categorical_accuracy: 0.9453 45/469 [=>............................] - ETA: 0s - loss: 0.1731 - sparse_categorical_accuracy: 0.9635  92/469 [====>.........................] - ETA: 0s - loss: 0.1609 - sparse_categorical_accuracy: 0.9641140/469 [=======>......................] - ETA: 0s - loss: 0.1504 - sparse_categorical_accuracy: 0.9653183/469 [==========>...................] - ETA: 0s - loss: 0.1495 - sparse_categorical_accuracy: 0.9646230/469 [=============>................] - ETA: 0s - loss: 0.1550 - sparse_categorical_accuracy: 0.9632276/469 [================>.............] - ETA: 0s - loss: 0.1532 - sparse_categorical_accuracy: 0.9633324/469 [===================>..........] - ETA: 0s - loss: 0.1506 - sparse_categorical_accuracy: 0.9639368/469 [======================>.......] - ETA: 0s - loss: 0.1498 - sparse_categorical_accuracy: 0.9640411/469 [=========================>....] - ETA: 0s - loss: 0.1502 - sparse_categorical_accuracy: 0.9637451/469 [===========================>..] - ETA: 0s - loss: 0.1507 - sparse_categorical_accuracy: 0.9636
Epoch 14: val_loss did not improve from 0.20374
469/469 [==============================] - 1s 1ms/step - loss: 0.1513 - sparse_categorical_accuracy: 0.9637 - val_loss: 0.2877 - val_sparse_categorical_accuracy: 0.9447
Epoch 15/20
  1/469 [..............................] - ETA: 12s - loss: 0.1153 - sparse_categorical_accuracy: 0.9609 45/469 [=>............................] - ETA: 0s - loss: 0.1351 - sparse_categorical_accuracy: 0.9642  90/469 [====>.........................] - ETA: 0s - loss: 0.1684 - sparse_categorical_accuracy: 0.9605130/469 [=======>......................] - ETA: 0s - loss: 0.1781 - sparse_categorical_accuracy: 0.9580173/469 [==========>...................] - ETA: 0s - loss: 0.1702 - sparse_categorical_accuracy: 0.9598215/469 [============>.................] - ETA: 0s - loss: 0.1713 - sparse_categorical_accuracy: 0.9598257/469 [===============>..............] - ETA: 0s - loss: 0.1635 - sparse_categorical_accuracy: 0.9612302/469 [==================>...........] - ETA: 0s - loss: 0.1609 - sparse_categorical_accuracy: 0.9617342/469 [====================>.........] - ETA: 0s - loss: 0.1610 - sparse_categorical_accuracy: 0.9615386/469 [=======================>......] - ETA: 0s - loss: 0.1593 - sparse_categorical_accuracy: 0.9618428/469 [==========================>...] - ETA: 0s - loss: 0.1590 - sparse_categorical_accuracy: 0.9616
Epoch 15: val_loss did not improve from 0.20374
469/469 [==============================] - 1s 1ms/step - loss: 0.1593 - sparse_categorical_accuracy: 0.9616 - val_loss: 0.2732 - val_sparse_categorical_accuracy: 0.9461
Epoch 16/20
  1/469 [..............................] - ETA: 12s - loss: 0.1183 - sparse_categorical_accuracy: 0.9844 44/469 [=>............................] - ETA: 0s - loss: 0.1282 - sparse_categorical_accuracy: 0.9645  88/469 [====>.........................] - ETA: 0s - loss: 0.1500 - sparse_categorical_accuracy: 0.9622130/469 [=======>......................] - ETA: 0s - loss: 0.1465 - sparse_categorical_accuracy: 0.9632173/469 [==========>...................] - ETA: 0s - loss: 0.1498 - sparse_categorical_accuracy: 0.9636217/469 [============>.................] - ETA: 0s - loss: 0.1504 - sparse_categorical_accuracy: 0.9640257/469 [===============>..............] - ETA: 0s - loss: 0.1561 - sparse_categorical_accuracy: 0.9630302/469 [==================>...........] - ETA: 0s - loss: 0.1500 - sparse_categorical_accuracy: 0.9642343/469 [====================>.........] - ETA: 0s - loss: 0.1501 - sparse_categorical_accuracy: 0.9639385/469 [=======================>......] - ETA: 0s - loss: 0.1496 - sparse_categorical_accuracy: 0.9637428/469 [==========================>...] - ETA: 0s - loss: 0.1491 - sparse_categorical_accuracy: 0.9642
Epoch 16: val_loss improved from 0.20374 to 0.18025, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1503 - sparse_categorical_accuracy: 0.9643 - val_loss: 0.1802 - val_sparse_categorical_accuracy: 0.9657
Epoch 17/20
  1/469 [..............................] - ETA: 12s - loss: 0.0204 - sparse_categorical_accuracy: 0.9922 45/469 [=>............................] - ETA: 0s - loss: 0.1191 - sparse_categorical_accuracy: 0.9694  90/469 [====>.........................] - ETA: 0s - loss: 0.1440 - sparse_categorical_accuracy: 0.9656133/469 [=======>......................] - ETA: 0s - loss: 0.1480 - sparse_categorical_accuracy: 0.9654174/469 [==========>...................] - ETA: 0s - loss: 0.1406 - sparse_categorical_accuracy: 0.9665216/469 [============>.................] - ETA: 0s - loss: 0.1373 - sparse_categorical_accuracy: 0.9674253/469 [===============>..............] - ETA: 0s - loss: 0.1435 - sparse_categorical_accuracy: 0.9662291/469 [=================>............] - ETA: 0s - loss: 0.1415 - sparse_categorical_accuracy: 0.9665329/469 [====================>.........] - ETA: 0s - loss: 0.1430 - sparse_categorical_accuracy: 0.9663368/469 [======================>.......] - ETA: 0s - loss: 0.1463 - sparse_categorical_accuracy: 0.9656407/469 [=========================>....] - ETA: 0s - loss: 0.1466 - sparse_categorical_accuracy: 0.9657445/469 [===========================>..] - ETA: 0s - loss: 0.1474 - sparse_categorical_accuracy: 0.9656
Epoch 17: val_loss did not improve from 0.18025
469/469 [==============================] - 1s 1ms/step - loss: 0.1490 - sparse_categorical_accuracy: 0.9654 - val_loss: 0.2410 - val_sparse_categorical_accuracy: 0.9572
Epoch 18/20
  1/469 [..............................] - ETA: 13s - loss: 0.1198 - sparse_categorical_accuracy: 0.9609 47/469 [==>...........................] - ETA: 0s - loss: 0.1141 - sparse_categorical_accuracy: 0.9721  90/469 [====>.........................] - ETA: 0s - loss: 0.1272 - sparse_categorical_accuracy: 0.9700134/469 [=======>......................] - ETA: 0s - loss: 0.1266 - sparse_categorical_accuracy: 0.9704170/469 [=========>....................] - ETA: 0s - loss: 0.1278 - sparse_categorical_accuracy: 0.9697209/469 [============>.................] - ETA: 0s - loss: 0.1277 - sparse_categorical_accuracy: 0.9698246/469 [==============>...............] - ETA: 0s - loss: 0.1287 - sparse_categorical_accuracy: 0.9696285/469 [=================>............] - ETA: 0s - loss: 0.1324 - sparse_categorical_accuracy: 0.9691322/469 [===================>..........] - ETA: 0s - loss: 0.1324 - sparse_categorical_accuracy: 0.9692360/469 [======================>.......] - ETA: 0s - loss: 0.1364 - sparse_categorical_accuracy: 0.9684398/469 [========================>.....] - ETA: 0s - loss: 0.1373 - sparse_categorical_accuracy: 0.9681437/469 [==========================>...] - ETA: 0s - loss: 0.1360 - sparse_categorical_accuracy: 0.9683
Epoch 18: val_loss did not improve from 0.18025
469/469 [==============================] - 1s 1ms/step - loss: 0.1367 - sparse_categorical_accuracy: 0.9684 - val_loss: 0.2217 - val_sparse_categorical_accuracy: 0.9612
Epoch 19/20
  1/469 [..............................] - ETA: 12s - loss: 0.0514 - sparse_categorical_accuracy: 0.9844 50/469 [==>...........................] - ETA: 0s - loss: 0.1426 - sparse_categorical_accuracy: 0.9691  99/469 [=====>........................] - ETA: 0s - loss: 0.1589 - sparse_categorical_accuracy: 0.9666146/469 [========>.....................] - ETA: 0s - loss: 0.1555 - sparse_categorical_accuracy: 0.9668188/469 [===========>..................] - ETA: 0s - loss: 0.1535 - sparse_categorical_accuracy: 0.9672234/469 [=============>................] - ETA: 0s - loss: 0.1540 - sparse_categorical_accuracy: 0.9674280/469 [================>.............] - ETA: 0s - loss: 0.1484 - sparse_categorical_accuracy: 0.9676321/469 [===================>..........] - ETA: 0s - loss: 0.1442 - sparse_categorical_accuracy: 0.9684362/469 [======================>.......] - ETA: 0s - loss: 0.1437 - sparse_categorical_accuracy: 0.9688401/469 [========================>.....] - ETA: 0s - loss: 0.1456 - sparse_categorical_accuracy: 0.9689438/469 [===========================>..] - ETA: 0s - loss: 0.1464 - sparse_categorical_accuracy: 0.9687
Epoch 19: val_loss did not improve from 0.18025
469/469 [==============================] - 1s 1ms/step - loss: 0.1452 - sparse_categorical_accuracy: 0.9687 - val_loss: 0.2666 - val_sparse_categorical_accuracy: 0.9576
Epoch 20/20
  1/469 [..............................] - ETA: 12s - loss: 0.0940 - sparse_categorical_accuracy: 0.9844 49/469 [==>...........................] - ETA: 0s - loss: 0.1373 - sparse_categorical_accuracy: 0.9700  91/469 [====>.........................] - ETA: 0s - loss: 0.1364 - sparse_categorical_accuracy: 0.9693132/469 [=======>......................] - ETA: 0s - loss: 0.1323 - sparse_categorical_accuracy: 0.9702174/469 [==========>...................] - ETA: 0s - loss: 0.1348 - sparse_categorical_accuracy: 0.9691215/469 [============>.................] - ETA: 0s - loss: 0.1311 - sparse_categorical_accuracy: 0.9704257/469 [===============>..............] - ETA: 0s - loss: 0.1369 - sparse_categorical_accuracy: 0.9693294/469 [=================>............] - ETA: 0s - loss: 0.1403 - sparse_categorical_accuracy: 0.9691334/469 [====================>.........] - ETA: 0s - loss: 0.1427 - sparse_categorical_accuracy: 0.9686375/469 [======================>.......] - ETA: 0s - loss: 0.1418 - sparse_categorical_accuracy: 0.9687415/469 [=========================>....] - ETA: 0s - loss: 0.1421 - sparse_categorical_accuracy: 0.9683457/469 [============================>.] - ETA: 0s - loss: 0.1426 - sparse_categorical_accuracy: 0.9684
Epoch 20: val_loss did not improve from 0.18025
469/469 [==============================] - 1s 1ms/step - loss: 0.1420 - sparse_categorical_accuracy: 0.9685 - val_loss: 0.2226 - val_sparse_categorical_accuracy: 0.9635
Evaluting model with ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f3bd46b2310> has ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f3bd4622610> has ber = 1.0
 1/79 [..............................] - ETA: 1s - loss: 0.1107 - sparse_categorical_accuracy: 0.960963/79 [======================>.......] - ETA: 0s - loss: 0.2329 - sparse_categorical_accuracy: 0.961779/79 [==============================] - 0s 819us/step - loss: 0.2226 - sparse_categorical_accuracy: 0.9635

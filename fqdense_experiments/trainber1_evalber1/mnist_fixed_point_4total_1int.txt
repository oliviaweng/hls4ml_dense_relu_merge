2022-08-23 11:07:59.378098: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:07:59.382171: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:07:59.382487: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:07:59.382953: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-08-23 11:07:59.383578: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:07:59.383882: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:07:59.384167: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:07:59.659262: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:07:59.659551: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:07:59.659809: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2022-08-23 11:07:59.660052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 6567 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1070, pci bus id: 0000:0a:00.0, compute capability: 6.1
Logit total bits = 4, int bits = 1
Activation total bits = 4, int bits = 1
<keras.engine.functional.Functional object at 0x7f9ad0769bd0>
#################
# MODEL SUMMARY #
#################
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 28, 28)]          0         
                                                                 
 flatten (Flatten)           (None, 784)               0         
                                                                 
 fq_dense (FQDense)          (None, 128)               100480    
                                                                 
 q_activation_1 (QActivation  (None, 128)              0         
 )                                                               
                                                                 
 fq_dense_1 (FQDense)        (None, 10)                1290      
                                                                 
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
None
#################
Training with ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f9adc3ce3d0> has ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f9ad0769b50> has ber = 1.0
Epoch 1/20
  1/469 [..............................] - ETA: 21:27 - loss: 7.7489 - sparse_categorical_accuracy: 0.1250 45/469 [=>............................] - ETA: 0s - loss: 3.6820 - sparse_categorical_accuracy: 0.1418    91/469 [====>.........................] - ETA: 0s - loss: 2.9605 - sparse_categorical_accuracy: 0.1682136/469 [=======>......................] - ETA: 0s - loss: 2.6802 - sparse_categorical_accuracy: 0.1951180/469 [==========>...................] - ETA: 0s - loss: 2.5134 - sparse_categorical_accuracy: 0.2183222/469 [=============>................] - ETA: 0s - loss: 2.3907 - sparse_categorical_accuracy: 0.2426260/469 [===============>..............] - ETA: 0s - loss: 2.3049 - sparse_categorical_accuracy: 0.2614299/469 [==================>...........] - ETA: 0s - loss: 2.2220 - sparse_categorical_accuracy: 0.2821339/469 [====================>.........] - ETA: 0s - loss: 2.1392 - sparse_categorical_accuracy: 0.3050380/469 [=======================>......] - ETA: 0s - loss: 2.0519 - sparse_categorical_accuracy: 0.3317421/469 [=========================>....] - ETA: 0s - loss: 1.9679 - sparse_categorical_accuracy: 0.3591460/469 [============================>.] - ETA: 0s - loss: 1.8896 - sparse_categorical_accuracy: 0.3868
Epoch 1: val_loss improved from inf to 0.93288, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 4s 4ms/step - loss: 1.8722 - sparse_categorical_accuracy: 0.3928 - val_loss: 0.9329 - val_sparse_categorical_accuracy: 0.7227
Epoch 2/20
  1/469 [..............................] - ETA: 13s - loss: 0.9691 - sparse_categorical_accuracy: 0.7422 48/469 [==>...........................] - ETA: 0s - loss: 0.9531 - sparse_categorical_accuracy: 0.7176  92/469 [====>.........................] - ETA: 0s - loss: 0.9072 - sparse_categorical_accuracy: 0.7381136/469 [=======>......................] - ETA: 0s - loss: 0.8757 - sparse_categorical_accuracy: 0.7442177/469 [==========>...................] - ETA: 0s - loss: 0.8463 - sparse_categorical_accuracy: 0.7522219/469 [=============>................] - ETA: 0s - loss: 0.8103 - sparse_categorical_accuracy: 0.7637262/469 [===============>..............] - ETA: 0s - loss: 0.7873 - sparse_categorical_accuracy: 0.7694309/469 [==================>...........] - ETA: 0s - loss: 0.7607 - sparse_categorical_accuracy: 0.7766350/469 [=====================>........] - ETA: 0s - loss: 0.7381 - sparse_categorical_accuracy: 0.7839391/469 [========================>.....] - ETA: 0s - loss: 0.7213 - sparse_categorical_accuracy: 0.7886427/469 [==========================>...] - ETA: 0s - loss: 0.7092 - sparse_categorical_accuracy: 0.7920465/469 [============================>.] - ETA: 0s - loss: 0.6950 - sparse_categorical_accuracy: 0.7962
Epoch 2: val_loss improved from 0.93288 to 0.47744, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.6931 - sparse_categorical_accuracy: 0.7968 - val_loss: 0.4774 - val_sparse_categorical_accuracy: 0.8645
Epoch 3/20
  1/469 [..............................] - ETA: 13s - loss: 0.5822 - sparse_categorical_accuracy: 0.8359 46/469 [=>............................] - ETA: 0s - loss: 0.5276 - sparse_categorical_accuracy: 0.8454  82/469 [====>.........................] - ETA: 0s - loss: 0.5039 - sparse_categorical_accuracy: 0.8537119/469 [======>.......................] - ETA: 0s - loss: 0.4915 - sparse_categorical_accuracy: 0.8559157/469 [=========>....................] - ETA: 0s - loss: 0.4878 - sparse_categorical_accuracy: 0.8559199/469 [===========>..................] - ETA: 0s - loss: 0.4784 - sparse_categorical_accuracy: 0.8586245/469 [==============>...............] - ETA: 0s - loss: 0.4712 - sparse_categorical_accuracy: 0.8601290/469 [=================>............] - ETA: 0s - loss: 0.4650 - sparse_categorical_accuracy: 0.8617340/469 [====================>.........] - ETA: 0s - loss: 0.4594 - sparse_categorical_accuracy: 0.8636389/469 [=======================>......] - ETA: 0s - loss: 0.4558 - sparse_categorical_accuracy: 0.8649427/469 [==========================>...] - ETA: 0s - loss: 0.4490 - sparse_categorical_accuracy: 0.8671469/469 [==============================] - ETA: 0s - loss: 0.4431 - sparse_categorical_accuracy: 0.8685
Epoch 3: val_loss improved from 0.47744 to 0.40707, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.4431 - sparse_categorical_accuracy: 0.8685 - val_loss: 0.4071 - val_sparse_categorical_accuracy: 0.8842
Epoch 4/20
  1/469 [..............................] - ETA: 12s - loss: 0.4552 - sparse_categorical_accuracy: 0.8984 50/469 [==>...........................] - ETA: 0s - loss: 0.3798 - sparse_categorical_accuracy: 0.8863  95/469 [=====>........................] - ETA: 0s - loss: 0.3747 - sparse_categorical_accuracy: 0.8891136/469 [=======>......................] - ETA: 0s - loss: 0.3683 - sparse_categorical_accuracy: 0.8918174/469 [==========>...................] - ETA: 0s - loss: 0.3669 - sparse_categorical_accuracy: 0.8915212/469 [============>.................] - ETA: 0s - loss: 0.3685 - sparse_categorical_accuracy: 0.8912250/469 [==============>...............] - ETA: 0s - loss: 0.3692 - sparse_categorical_accuracy: 0.8913290/469 [=================>............] - ETA: 0s - loss: 0.3719 - sparse_categorical_accuracy: 0.8905330/469 [====================>.........] - ETA: 0s - loss: 0.3710 - sparse_categorical_accuracy: 0.8904367/469 [======================>.......] - ETA: 0s - loss: 0.3670 - sparse_categorical_accuracy: 0.8918400/469 [========================>.....] - ETA: 0s - loss: 0.3644 - sparse_categorical_accuracy: 0.8924432/469 [==========================>...] - ETA: 0s - loss: 0.3629 - sparse_categorical_accuracy: 0.8926468/469 [============================>.] - ETA: 0s - loss: 0.3601 - sparse_categorical_accuracy: 0.8934
Epoch 4: val_loss improved from 0.40707 to 0.33473, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 2ms/step - loss: 0.3600 - sparse_categorical_accuracy: 0.8934 - val_loss: 0.3347 - val_sparse_categorical_accuracy: 0.9042
Epoch 5/20
  1/469 [..............................] - ETA: 12s - loss: 0.3632 - sparse_categorical_accuracy: 0.8828 50/469 [==>...........................] - ETA: 0s - loss: 0.3222 - sparse_categorical_accuracy: 0.9036  91/469 [====>.........................] - ETA: 0s - loss: 0.3202 - sparse_categorical_accuracy: 0.9040132/469 [=======>......................] - ETA: 0s - loss: 0.3263 - sparse_categorical_accuracy: 0.9012172/469 [==========>...................] - ETA: 0s - loss: 0.3277 - sparse_categorical_accuracy: 0.9021215/469 [============>.................] - ETA: 0s - loss: 0.3287 - sparse_categorical_accuracy: 0.9016262/469 [===============>..............] - ETA: 0s - loss: 0.3245 - sparse_categorical_accuracy: 0.9025299/469 [==================>...........] - ETA: 0s - loss: 0.3213 - sparse_categorical_accuracy: 0.9034337/469 [====================>.........] - ETA: 0s - loss: 0.3208 - sparse_categorical_accuracy: 0.9034386/469 [=======================>......] - ETA: 0s - loss: 0.3198 - sparse_categorical_accuracy: 0.9040427/469 [==========================>...] - ETA: 0s - loss: 0.3199 - sparse_categorical_accuracy: 0.9040466/469 [============================>.] - ETA: 0s - loss: 0.3190 - sparse_categorical_accuracy: 0.9046
Epoch 5: val_loss improved from 0.33473 to 0.28027, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.3193 - sparse_categorical_accuracy: 0.9046 - val_loss: 0.2803 - val_sparse_categorical_accuracy: 0.9195
Epoch 6/20
  1/469 [..............................] - ETA: 13s - loss: 0.1978 - sparse_categorical_accuracy: 0.9297 45/469 [=>............................] - ETA: 0s - loss: 0.2929 - sparse_categorical_accuracy: 0.9094  83/469 [====>.........................] - ETA: 0s - loss: 0.3060 - sparse_categorical_accuracy: 0.9065123/469 [======>.......................] - ETA: 0s - loss: 0.3059 - sparse_categorical_accuracy: 0.9073164/469 [=========>....................] - ETA: 0s - loss: 0.3017 - sparse_categorical_accuracy: 0.9090201/469 [===========>..................] - ETA: 0s - loss: 0.2993 - sparse_categorical_accuracy: 0.9090240/469 [==============>...............] - ETA: 0s - loss: 0.2957 - sparse_categorical_accuracy: 0.9110281/469 [================>.............] - ETA: 0s - loss: 0.2990 - sparse_categorical_accuracy: 0.9103318/469 [===================>..........] - ETA: 0s - loss: 0.2963 - sparse_categorical_accuracy: 0.9109356/469 [=====================>........] - ETA: 0s - loss: 0.2964 - sparse_categorical_accuracy: 0.9109394/469 [========================>.....] - ETA: 0s - loss: 0.2917 - sparse_categorical_accuracy: 0.9123434/469 [==========================>...] - ETA: 0s - loss: 0.2892 - sparse_categorical_accuracy: 0.9132
Epoch 6: val_loss did not improve from 0.28027
469/469 [==============================] - 1s 1ms/step - loss: 0.2878 - sparse_categorical_accuracy: 0.9133 - val_loss: 0.2899 - val_sparse_categorical_accuracy: 0.9176
Epoch 7/20
  1/469 [..............................] - ETA: 12s - loss: 0.3222 - sparse_categorical_accuracy: 0.9219 50/469 [==>...........................] - ETA: 0s - loss: 0.2950 - sparse_categorical_accuracy: 0.9130  94/469 [=====>........................] - ETA: 0s - loss: 0.2850 - sparse_categorical_accuracy: 0.9151139/469 [=======>......................] - ETA: 0s - loss: 0.2825 - sparse_categorical_accuracy: 0.9166180/469 [==========>...................] - ETA: 0s - loss: 0.2783 - sparse_categorical_accuracy: 0.9177222/469 [=============>................] - ETA: 0s - loss: 0.2801 - sparse_categorical_accuracy: 0.9168266/469 [================>.............] - ETA: 0s - loss: 0.2801 - sparse_categorical_accuracy: 0.9169305/469 [==================>...........] - ETA: 0s - loss: 0.2785 - sparse_categorical_accuracy: 0.9176350/469 [=====================>........] - ETA: 0s - loss: 0.2766 - sparse_categorical_accuracy: 0.9178394/469 [========================>.....] - ETA: 0s - loss: 0.2749 - sparse_categorical_accuracy: 0.9183437/469 [==========================>...] - ETA: 0s - loss: 0.2747 - sparse_categorical_accuracy: 0.9183
Epoch 7: val_loss did not improve from 0.28027
469/469 [==============================] - 1s 1ms/step - loss: 0.2727 - sparse_categorical_accuracy: 0.9190 - val_loss: 0.2805 - val_sparse_categorical_accuracy: 0.9161
Epoch 8/20
  1/469 [..............................] - ETA: 13s - loss: 0.2053 - sparse_categorical_accuracy: 0.9141 46/469 [=>............................] - ETA: 0s - loss: 0.2423 - sparse_categorical_accuracy: 0.9261  90/469 [====>.........................] - ETA: 0s - loss: 0.2567 - sparse_categorical_accuracy: 0.9253134/469 [=======>......................] - ETA: 0s - loss: 0.2503 - sparse_categorical_accuracy: 0.9264181/469 [==========>...................] - ETA: 0s - loss: 0.2549 - sparse_categorical_accuracy: 0.9247230/469 [=============>................] - ETA: 0s - loss: 0.2517 - sparse_categorical_accuracy: 0.9246274/469 [================>.............] - ETA: 0s - loss: 0.2510 - sparse_categorical_accuracy: 0.9250318/469 [===================>..........] - ETA: 0s - loss: 0.2520 - sparse_categorical_accuracy: 0.9251360/469 [======================>.......] - ETA: 0s - loss: 0.2527 - sparse_categorical_accuracy: 0.9250397/469 [========================>.....] - ETA: 0s - loss: 0.2522 - sparse_categorical_accuracy: 0.9253430/469 [==========================>...] - ETA: 0s - loss: 0.2522 - sparse_categorical_accuracy: 0.9254462/469 [============================>.] - ETA: 0s - loss: 0.2538 - sparse_categorical_accuracy: 0.9251
Epoch 8: val_loss improved from 0.28027 to 0.25888, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.2536 - sparse_categorical_accuracy: 0.9253 - val_loss: 0.2589 - val_sparse_categorical_accuracy: 0.9272
Epoch 9/20
  1/469 [..............................] - ETA: 13s - loss: 0.1455 - sparse_categorical_accuracy: 0.9375 49/469 [==>...........................] - ETA: 0s - loss: 0.2227 - sparse_categorical_accuracy: 0.9340  92/469 [====>.........................] - ETA: 0s - loss: 0.2356 - sparse_categorical_accuracy: 0.9302135/469 [=======>......................] - ETA: 0s - loss: 0.2340 - sparse_categorical_accuracy: 0.9308178/469 [==========>...................] - ETA: 0s - loss: 0.2342 - sparse_categorical_accuracy: 0.9309222/469 [=============>................] - ETA: 0s - loss: 0.2364 - sparse_categorical_accuracy: 0.9303269/469 [================>.............] - ETA: 0s - loss: 0.2392 - sparse_categorical_accuracy: 0.9289311/469 [==================>...........] - ETA: 0s - loss: 0.2371 - sparse_categorical_accuracy: 0.9292355/469 [=====================>........] - ETA: 0s - loss: 0.2376 - sparse_categorical_accuracy: 0.9295397/469 [========================>.....] - ETA: 0s - loss: 0.2387 - sparse_categorical_accuracy: 0.9289438/469 [===========================>..] - ETA: 0s - loss: 0.2401 - sparse_categorical_accuracy: 0.9287
Epoch 9: val_loss improved from 0.25888 to 0.24211, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.2395 - sparse_categorical_accuracy: 0.9289 - val_loss: 0.2421 - val_sparse_categorical_accuracy: 0.9317
Epoch 10/20
  1/469 [..............................] - ETA: 13s - loss: 0.1654 - sparse_categorical_accuracy: 0.9375 46/469 [=>............................] - ETA: 0s - loss: 0.2206 - sparse_categorical_accuracy: 0.9324  88/469 [====>.........................] - ETA: 0s - loss: 0.2234 - sparse_categorical_accuracy: 0.9320129/469 [=======>......................] - ETA: 0s - loss: 0.2302 - sparse_categorical_accuracy: 0.9307168/469 [=========>....................] - ETA: 0s - loss: 0.2361 - sparse_categorical_accuracy: 0.9296206/469 [============>.................] - ETA: 0s - loss: 0.2378 - sparse_categorical_accuracy: 0.9290246/469 [==============>...............] - ETA: 0s - loss: 0.2351 - sparse_categorical_accuracy: 0.9297280/469 [================>.............] - ETA: 0s - loss: 0.2347 - sparse_categorical_accuracy: 0.9294313/469 [===================>..........] - ETA: 0s - loss: 0.2368 - sparse_categorical_accuracy: 0.9289351/469 [=====================>........] - ETA: 0s - loss: 0.2350 - sparse_categorical_accuracy: 0.9294387/469 [=======================>......] - ETA: 0s - loss: 0.2343 - sparse_categorical_accuracy: 0.9295425/469 [==========================>...] - ETA: 0s - loss: 0.2319 - sparse_categorical_accuracy: 0.9301463/469 [============================>.] - ETA: 0s - loss: 0.2306 - sparse_categorical_accuracy: 0.9306
Epoch 10: val_loss did not improve from 0.24211
469/469 [==============================] - 1s 1ms/step - loss: 0.2305 - sparse_categorical_accuracy: 0.9307 - val_loss: 0.2421 - val_sparse_categorical_accuracy: 0.9291
Epoch 11/20
  1/469 [..............................] - ETA: 14s - loss: 0.2699 - sparse_categorical_accuracy: 0.9375 51/469 [==>...........................] - ETA: 0s - loss: 0.2413 - sparse_categorical_accuracy: 0.9291  99/469 [=====>........................] - ETA: 0s - loss: 0.2285 - sparse_categorical_accuracy: 0.9332144/469 [========>.....................] - ETA: 0s - loss: 0.2208 - sparse_categorical_accuracy: 0.9350189/469 [===========>..................] - ETA: 0s - loss: 0.2152 - sparse_categorical_accuracy: 0.9363228/469 [=============>................] - ETA: 0s - loss: 0.2187 - sparse_categorical_accuracy: 0.9360271/469 [================>.............] - ETA: 0s - loss: 0.2185 - sparse_categorical_accuracy: 0.9356308/469 [==================>...........] - ETA: 0s - loss: 0.2161 - sparse_categorical_accuracy: 0.9360346/469 [=====================>........] - ETA: 0s - loss: 0.2164 - sparse_categorical_accuracy: 0.9361382/469 [=======================>......] - ETA: 0s - loss: 0.2165 - sparse_categorical_accuracy: 0.9358423/469 [==========================>...] - ETA: 0s - loss: 0.2177 - sparse_categorical_accuracy: 0.9356462/469 [============================>.] - ETA: 0s - loss: 0.2185 - sparse_categorical_accuracy: 0.9355
Epoch 11: val_loss did not improve from 0.24211
469/469 [==============================] - 1s 1ms/step - loss: 0.2183 - sparse_categorical_accuracy: 0.9355 - val_loss: 0.2437 - val_sparse_categorical_accuracy: 0.9279
Epoch 12/20
  1/469 [..............................] - ETA: 16s - loss: 0.1957 - sparse_categorical_accuracy: 0.9375 42/469 [=>............................] - ETA: 0s - loss: 0.2056 - sparse_categorical_accuracy: 0.9425  78/469 [===>..........................] - ETA: 0s - loss: 0.2067 - sparse_categorical_accuracy: 0.9401112/469 [======>.......................] - ETA: 0s - loss: 0.1997 - sparse_categorical_accuracy: 0.9405144/469 [========>.....................] - ETA: 0s - loss: 0.1973 - sparse_categorical_accuracy: 0.9411181/469 [==========>...................] - ETA: 0s - loss: 0.2042 - sparse_categorical_accuracy: 0.9402220/469 [=============>................] - ETA: 0s - loss: 0.2055 - sparse_categorical_accuracy: 0.9392260/469 [===============>..............] - ETA: 0s - loss: 0.2026 - sparse_categorical_accuracy: 0.9401301/469 [==================>...........] - ETA: 0s - loss: 0.2007 - sparse_categorical_accuracy: 0.9403350/469 [=====================>........] - ETA: 0s - loss: 0.2013 - sparse_categorical_accuracy: 0.9398396/469 [========================>.....] - ETA: 0s - loss: 0.2033 - sparse_categorical_accuracy: 0.9389440/469 [===========================>..] - ETA: 0s - loss: 0.2052 - sparse_categorical_accuracy: 0.9390
Epoch 12: val_loss did not improve from 0.24211
469/469 [==============================] - 1s 1ms/step - loss: 0.2086 - sparse_categorical_accuracy: 0.9381 - val_loss: 0.2455 - val_sparse_categorical_accuracy: 0.9332
Epoch 13/20
  1/469 [..............................] - ETA: 13s - loss: 0.2783 - sparse_categorical_accuracy: 0.9141 43/469 [=>............................] - ETA: 0s - loss: 0.1969 - sparse_categorical_accuracy: 0.9384  85/469 [====>.........................] - ETA: 0s - loss: 0.1969 - sparse_categorical_accuracy: 0.9392132/469 [=======>......................] - ETA: 0s - loss: 0.1906 - sparse_categorical_accuracy: 0.9405179/469 [==========>...................] - ETA: 0s - loss: 0.1907 - sparse_categorical_accuracy: 0.9408221/469 [=============>................] - ETA: 0s - loss: 0.1956 - sparse_categorical_accuracy: 0.9408266/469 [================>.............] - ETA: 0s - loss: 0.1972 - sparse_categorical_accuracy: 0.9406308/469 [==================>...........] - ETA: 0s - loss: 0.1975 - sparse_categorical_accuracy: 0.9403356/469 [=====================>........] - ETA: 0s - loss: 0.2012 - sparse_categorical_accuracy: 0.9397400/469 [========================>.....] - ETA: 0s - loss: 0.2018 - sparse_categorical_accuracy: 0.9398443/469 [===========================>..] - ETA: 0s - loss: 0.2021 - sparse_categorical_accuracy: 0.9396
Epoch 13: val_loss did not improve from 0.24211
469/469 [==============================] - 1s 1ms/step - loss: 0.2034 - sparse_categorical_accuracy: 0.9395 - val_loss: 0.2846 - val_sparse_categorical_accuracy: 0.9222
Epoch 14/20
  1/469 [..............................] - ETA: 14s - loss: 0.3399 - sparse_categorical_accuracy: 0.9062 49/469 [==>...........................] - ETA: 0s - loss: 0.1973 - sparse_categorical_accuracy: 0.9402  94/469 [=====>........................] - ETA: 0s - loss: 0.2019 - sparse_categorical_accuracy: 0.9392138/469 [=======>......................] - ETA: 0s - loss: 0.2029 - sparse_categorical_accuracy: 0.9401182/469 [==========>...................] - ETA: 0s - loss: 0.2012 - sparse_categorical_accuracy: 0.9403226/469 [=============>................] - ETA: 0s - loss: 0.2014 - sparse_categorical_accuracy: 0.9404265/469 [===============>..............] - ETA: 0s - loss: 0.2000 - sparse_categorical_accuracy: 0.9402301/469 [==================>...........] - ETA: 0s - loss: 0.2015 - sparse_categorical_accuracy: 0.9402340/469 [====================>.........] - ETA: 0s - loss: 0.1997 - sparse_categorical_accuracy: 0.9405380/469 [=======================>......] - ETA: 0s - loss: 0.1994 - sparse_categorical_accuracy: 0.9407422/469 [=========================>....] - ETA: 0s - loss: 0.1972 - sparse_categorical_accuracy: 0.9416461/469 [============================>.] - ETA: 0s - loss: 0.1980 - sparse_categorical_accuracy: 0.9415
Epoch 14: val_loss improved from 0.24211 to 0.23238, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1979 - sparse_categorical_accuracy: 0.9415 - val_loss: 0.2324 - val_sparse_categorical_accuracy: 0.9379
Epoch 15/20
  1/469 [..............................] - ETA: 12s - loss: 0.1193 - sparse_categorical_accuracy: 0.9609 45/469 [=>............................] - ETA: 0s - loss: 0.1916 - sparse_categorical_accuracy: 0.9425  84/469 [====>.........................] - ETA: 0s - loss: 0.1818 - sparse_categorical_accuracy: 0.9444121/469 [======>.......................] - ETA: 0s - loss: 0.1881 - sparse_categorical_accuracy: 0.9437156/469 [========>.....................] - ETA: 0s - loss: 0.1854 - sparse_categorical_accuracy: 0.9442191/469 [===========>..................] - ETA: 0s - loss: 0.1825 - sparse_categorical_accuracy: 0.9450231/469 [=============>................] - ETA: 0s - loss: 0.1833 - sparse_categorical_accuracy: 0.9449271/469 [================>.............] - ETA: 0s - loss: 0.1849 - sparse_categorical_accuracy: 0.9440309/469 [==================>...........] - ETA: 0s - loss: 0.1852 - sparse_categorical_accuracy: 0.9444352/469 [=====================>........] - ETA: 0s - loss: 0.1868 - sparse_categorical_accuracy: 0.9443394/469 [========================>.....] - ETA: 0s - loss: 0.1909 - sparse_categorical_accuracy: 0.9432434/469 [==========================>...] - ETA: 0s - loss: 0.1926 - sparse_categorical_accuracy: 0.9427
Epoch 15: val_loss did not improve from 0.23238
469/469 [==============================] - 1s 1ms/step - loss: 0.1929 - sparse_categorical_accuracy: 0.9430 - val_loss: 0.2467 - val_sparse_categorical_accuracy: 0.9297
Epoch 16/20
  1/469 [..............................] - ETA: 12s - loss: 0.1693 - sparse_categorical_accuracy: 0.9219 51/469 [==>...........................] - ETA: 0s - loss: 0.1809 - sparse_categorical_accuracy: 0.9452  99/469 [=====>........................] - ETA: 0s - loss: 0.1745 - sparse_categorical_accuracy: 0.9476144/469 [========>.....................] - ETA: 0s - loss: 0.1712 - sparse_categorical_accuracy: 0.9492184/469 [==========>...................] - ETA: 0s - loss: 0.1788 - sparse_categorical_accuracy: 0.9474224/469 [=============>................] - ETA: 0s - loss: 0.1844 - sparse_categorical_accuracy: 0.9472264/469 [===============>..............] - ETA: 0s - loss: 0.1835 - sparse_categorical_accuracy: 0.9476304/469 [==================>...........] - ETA: 0s - loss: 0.1837 - sparse_categorical_accuracy: 0.9474344/469 [=====================>........] - ETA: 0s - loss: 0.1864 - sparse_categorical_accuracy: 0.9463381/469 [=======================>......] - ETA: 0s - loss: 0.1859 - sparse_categorical_accuracy: 0.9460421/469 [=========================>....] - ETA: 0s - loss: 0.1851 - sparse_categorical_accuracy: 0.9462461/469 [============================>.] - ETA: 0s - loss: 0.1847 - sparse_categorical_accuracy: 0.9462
Epoch 16: val_loss did not improve from 0.23238
469/469 [==============================] - 1s 1ms/step - loss: 0.1843 - sparse_categorical_accuracy: 0.9462 - val_loss: 0.2463 - val_sparse_categorical_accuracy: 0.9371
Epoch 17/20
  1/469 [..............................] - ETA: 14s - loss: 0.1296 - sparse_categorical_accuracy: 0.9531 47/469 [==>...........................] - ETA: 0s - loss: 0.1512 - sparse_categorical_accuracy: 0.9523  94/469 [=====>........................] - ETA: 0s - loss: 0.1601 - sparse_categorical_accuracy: 0.9517141/469 [========>.....................] - ETA: 0s - loss: 0.1634 - sparse_categorical_accuracy: 0.9504181/469 [==========>...................] - ETA: 0s - loss: 0.1698 - sparse_categorical_accuracy: 0.9483222/469 [=============>................] - ETA: 0s - loss: 0.1754 - sparse_categorical_accuracy: 0.9472265/469 [===============>..............] - ETA: 0s - loss: 0.1788 - sparse_categorical_accuracy: 0.9464307/469 [==================>...........] - ETA: 0s - loss: 0.1797 - sparse_categorical_accuracy: 0.9472346/469 [=====================>........] - ETA: 0s - loss: 0.1801 - sparse_categorical_accuracy: 0.9468386/469 [=======================>......] - ETA: 0s - loss: 0.1819 - sparse_categorical_accuracy: 0.9462424/469 [==========================>...] - ETA: 0s - loss: 0.1811 - sparse_categorical_accuracy: 0.9466462/469 [============================>.] - ETA: 0s - loss: 0.1835 - sparse_categorical_accuracy: 0.9463
Epoch 17: val_loss improved from 0.23238 to 0.21760, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1832 - sparse_categorical_accuracy: 0.9464 - val_loss: 0.2176 - val_sparse_categorical_accuracy: 0.9396
Epoch 18/20
  1/469 [..............................] - ETA: 13s - loss: 0.1346 - sparse_categorical_accuracy: 0.9531 52/469 [==>...........................] - ETA: 0s - loss: 0.1536 - sparse_categorical_accuracy: 0.9534 103/469 [=====>........................] - ETA: 0s - loss: 0.1595 - sparse_categorical_accuracy: 0.9521153/469 [========>.....................] - ETA: 0s - loss: 0.1625 - sparse_categorical_accuracy: 0.9511203/469 [===========>..................] - ETA: 0s - loss: 0.1673 - sparse_categorical_accuracy: 0.9501252/469 [===============>..............] - ETA: 0s - loss: 0.1657 - sparse_categorical_accuracy: 0.9506302/469 [==================>...........] - ETA: 0s - loss: 0.1660 - sparse_categorical_accuracy: 0.9504352/469 [=====================>........] - ETA: 0s - loss: 0.1672 - sparse_categorical_accuracy: 0.9504402/469 [========================>.....] - ETA: 0s - loss: 0.1695 - sparse_categorical_accuracy: 0.9499453/469 [===========================>..] - ETA: 0s - loss: 0.1693 - sparse_categorical_accuracy: 0.9501
Epoch 18: val_loss improved from 0.21760 to 0.19732, saving model to faulty_qdense_mnist/model_best.h5
469/469 [==============================] - 1s 1ms/step - loss: 0.1690 - sparse_categorical_accuracy: 0.9500 - val_loss: 0.1973 - val_sparse_categorical_accuracy: 0.9458
Epoch 19/20
  1/469 [..............................] - ETA: 12s - loss: 0.1917 - sparse_categorical_accuracy: 0.9219 46/469 [=>............................] - ETA: 0s - loss: 0.1428 - sparse_categorical_accuracy: 0.9536  94/469 [=====>........................] - ETA: 0s - loss: 0.1452 - sparse_categorical_accuracy: 0.9550136/469 [=======>......................] - ETA: 0s - loss: 0.1454 - sparse_categorical_accuracy: 0.9562175/469 [==========>...................] - ETA: 0s - loss: 0.1469 - sparse_categorical_accuracy: 0.9559211/469 [============>.................] - ETA: 0s - loss: 0.1498 - sparse_categorical_accuracy: 0.9557249/469 [==============>...............] - ETA: 0s - loss: 0.1504 - sparse_categorical_accuracy: 0.9557288/469 [=================>............] - ETA: 0s - loss: 0.1576 - sparse_categorical_accuracy: 0.9533326/469 [===================>..........] - ETA: 0s - loss: 0.1604 - sparse_categorical_accuracy: 0.9531369/469 [======================>.......] - ETA: 0s - loss: 0.1630 - sparse_categorical_accuracy: 0.9520409/469 [=========================>....] - ETA: 0s - loss: 0.1617 - sparse_categorical_accuracy: 0.9527458/469 [============================>.] - ETA: 0s - loss: 0.1623 - sparse_categorical_accuracy: 0.9528
Epoch 19: val_loss did not improve from 0.19732
469/469 [==============================] - 1s 1ms/step - loss: 0.1635 - sparse_categorical_accuracy: 0.9526 - val_loss: 0.2421 - val_sparse_categorical_accuracy: 0.9356
Epoch 20/20
  1/469 [..............................] - ETA: 12s - loss: 0.1827 - sparse_categorical_accuracy: 0.9453 48/469 [==>...........................] - ETA: 0s - loss: 0.1558 - sparse_categorical_accuracy: 0.9515  89/469 [====>.........................] - ETA: 0s - loss: 0.1553 - sparse_categorical_accuracy: 0.9529138/469 [=======>......................] - ETA: 0s - loss: 0.1607 - sparse_categorical_accuracy: 0.9530186/469 [==========>...................] - ETA: 0s - loss: 0.1614 - sparse_categorical_accuracy: 0.9532237/469 [==============>...............] - ETA: 0s - loss: 0.1593 - sparse_categorical_accuracy: 0.9545286/469 [=================>............] - ETA: 0s - loss: 0.1599 - sparse_categorical_accuracy: 0.9546325/469 [===================>..........] - ETA: 0s - loss: 0.1592 - sparse_categorical_accuracy: 0.9545365/469 [======================>.......] - ETA: 0s - loss: 0.1584 - sparse_categorical_accuracy: 0.9545405/469 [========================>.....] - ETA: 0s - loss: 0.1608 - sparse_categorical_accuracy: 0.9534441/469 [===========================>..] - ETA: 0s - loss: 0.1622 - sparse_categorical_accuracy: 0.9530
Epoch 20: val_loss did not improve from 0.19732
469/469 [==============================] - 1s 1ms/step - loss: 0.1642 - sparse_categorical_accuracy: 0.9525 - val_loss: 0.3137 - val_sparse_categorical_accuracy: 0.9174
Evaluting model with ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f9adc3ce3d0> has ber = 1.0
Layer <fkeras.fdense.FQDense object at 0x7f9ad0769b50> has ber = 1.0
 1/79 [..............................] - ETA: 1s - loss: 0.2821 - sparse_categorical_accuracy: 0.929762/79 [======================>.......] - ETA: 0s - loss: 0.3117 - sparse_categorical_accuracy: 0.916279/79 [==============================] - 0s 825us/step - loss: 0.3137 - sparse_categorical_accuracy: 0.9174
